Das Modul \texttt{mpshift} umfasste bisher die Möglichkeit zur Berechnung von chemischen Abschirmungskonstanten in Molekülen ohne schwere Elemente (ab etwa $Z$=36) in der Gasphase. Diese Berechnungen konnten auf Hartree-Fock, \ac{dft} (für \ac{lda}- und \ac{gga}-Funktionale) und \ac{mp2} Nievau durchgeführt werden. Des Weiteren konnte die nach den Komponenten des Magnetfeldes abgeleitete Dichtematrix dem externen Programm \ac{gimic} zur Weiterverarbeitung bereit gestellt werden. Die folgenden Kapitel beschreiben die Erweiterung der Funktionalität des Moduls die im Rahmen dieser Arbeit implementiert wurden. Im Einzelnen sind dies die Berücksichtigung relativistischer Effekte auf Nachbaratome in Molekülen mit schweren Elementen durch relativistische \acp{ecp}, die Einbeziehung von Umgebungseffekten sowie die Bereitstellung der magnetischen Response zur Berechnung von \ac{vcd}-Spektren. Weiterhin wurde das Modul um die Möglichkeit ergänzt, \ac{mgga}-Funktionale für die Berechnung der Abschirmungskonstanten auf \ac{dft}-Niveau zu verwenden. Die eigentliche Implementierung dieses letzten Punktes erfolgte jedoch nicht von mir, sondern von Fabian Mack im Rahmen seiner Masterarbeit.\supercite{mack2017} 


\section{Berücksichtigung von Umgebungseffekten}
Isotrope chemische Verschiebungen werden üblicherweise in Lösung gemessen. Je nachdem wie stark das zu untersuchende Molekül mit dem Lösungsmittel wechselwirkt, hat das Lösungsmittel einen mehr oder weniger stark ausgeprägten Einfluss auf das gemessene Spektrum. Das \ac{cosmo}\supercite{klamt1993cosmo}, ein Kontinuumsmodell, ist in der Quantenchemie ein bewährtes Verfahren zur Berücksichtigung von Umgebungseffekten. Neben den Einflüssen des Lösungsmittels lassen sich damit auch für Ionen die Ladungen kompensieren, ohne die Gegenionen explizit mitrechnen zu müssen. Insbesondere hoch geladene Anionen lassen sich ohne eine solche Ladungskompensation nur schwer oder gar nicht berechnen. 

Neben \ac{cosmo} besteht auch die die Möglichkeit, Lösungsmittelmoleküle explizit in die Berechnung mit einzubeziehen. Soll eine größere Anzahl an Lösungsmitteln explizit betrachtet werden, um beispielsweise eine vollständige Solvatationshülle um das gelöste Molekül zu erhalten, so bieten sich \ac{md}-Simulationen an. Aus diesen Simulationen für ein bestimmtes Zeitintervall, lassen sich einzelne Schnappschüsse der Molekülkoordinaten extrahieren. Für diese einzelnen Koordinaten lassen sich dann \textit{ab initio} Rechnungen durchführen. Ein Vergleich solch unterschiedlicher Ansätze ist in Kapitel \ref{lömitest} für das Acetonmolekül in Wasser zu finden. 
	\subsection{Theorie}
	In einem Kontinuum-Lösungsmittel-Model (englisch \ac{csm}), wie dem \ac{cosmo}, wird das zu betrachtende Lösungsmittel durch seine Dielektrizitätskonstante $\varepsilon$ beschrieben. Das gelöste Molekül stellt dabei einen Hohlraum im dielektrischen Kontinuum dar und polarisiert das dielektrische Medium aufgrund seiner Ladungsverteilung. Zur Beschreibung der Reaktion des dielektrischen Mediums auf diese Polarisierung, werden auf der Oberfläche des durch das gelöste Molekül entstandenen Hohlraums sogenannte \textit{screening}-Ladungen generiert. In der Praxis wird also in einem bestimmten Abstand eine Hülle um das gelöste Molekül gelegt und auf der Oberfläche dieser Hülle befinden sich diese Ladungen. Beim \ac{cosmo} wird nun die Nebenbedingung eingeführt, dass das elektrostatische Potential auf der Oberfläche dieser Hülle verschwinden soll, was einem idealen Lösungsmittel mit unendlicher Dielektrizitätskonstante $\varepsilon=\infty$ entspricht. Das gesamte elektrostatische Potential $\vec{\phi}^{\textrm{Tot}}$ setzt sich aus dem Beitrag des gelösten Moleküls $\vec{\phi}^{\textrm{Mol}}$ und dem Beitrag der \textit{screening}-Ladungen $\boldsymbol{A}\vec{q}$. $\vec{\phi}^{\textrm{Mol}}$ beinhaltet dabei sowohl die Beiträge der Elektronen, als auch die der Kerne. Der Vektor $\vec{q}$ enthält die insgesamt $N_{\textrm{SL}}$ \textit{screening}-Ladungen und die Matrix $\boldsymbol{A}$ beinhaltet die Coulombwechselwirkung der \textit{screening}-Ladungen untereinander. Mit der Bedingung des verschwindenden elektrostatischen Potentials folgt daher
	
	\begin{equation}
	\vec{\phi}^{\textrm{Tot}}=\vec{\phi}^{\textrm{Mol}}+\boldsymbol{A}\vec{q}=0,
	\end{equation}
	
wodurch sich die \textit{screening}-Ladungen definieren lassen
	\begin{equation}
	\vec{q}=\boldsymbol{A}^{-1}\vec{\phi}^{\textrm{Mol}}
	\end{equation}
Um nun Lösungsmittel mit unterschiedlichen Dielektrizitätskonstanten betrachten zu können, wird ein Skalierungsfaktor $f(\varepsilon)$ eingeführt
	\begin{equation}
	f(\varepsilon)=\frac{\varepsilon-1}{\varepsilon+\frac{1}{2}}
	\end{equation}
und damit lassen sich die entsprechenden \textit{screening}-Ladungen $\vec{q}(\varepsilon)$ erhalten
	\begin{equation}
	\vec{q}(\varepsilon)=\vec{q}(\varepsilon=\infty)f(\varepsilon).
	\end{equation}
Die Abweichungen aufgrund der hier gewählten Nebenbedingung des verschwindenden elektrostatischen Potentials im Vergleich zu den eigentlich viel komplexeren Nebenbedingungen ist sehr gering.\supercite{klamt1993cosmo} Dies gilt insbesondere für Lösungsmittel mit großen Dielektrizitätskonstanten, wie beispielsweise Wasser.

Bei der Berechnung chemischer Abschirmungskonstanten müssen die erzeugten Punktladungen auf der Oberfläche der Hülle um das gelöste Molekül ebenfalls berücksichtigt werden. Die \textit{screening}-Ladungen ergeben einen zusätzlichen Energiebeitrag $E^{\textrm{SM}}$ für den Einelektronenteil\supercite{cammi1999nuclear}

	\begin{equation}\label{eq:esm}
	E^{\textrm{SM}}=\sum_{l}^{N_{\textrm{SL}}}\int\frac{q_l\rho(\vec{r})}{\vert\vec{t}_l-\vec{r}\vert}\diff\vec{r}=\sum_{\mu\nu}D_{\mu\nu}\underbrace{\sum_l^{N_{\textrm{SL}}}\int\frac{q_l\chi_\mu\chi_\nu}{\vert\vec{t}_l-\vec{r}\vert}\diff\vec{r}}_{V_{\mu\nu}^{\textrm{SM}}}.
	\end{equation}
mit den Positionen $\vec{t}_l$ der \textit{screening}-Ladungen. Für die chemischen Abschirmungskonstanten wird daher die Ableitung von Gleichung (\ref{eq:esm}) nach den Komponenten des Magnetfeldes benötigt. Dies führt schließlich zu

	\begin{equation}\label{eq:esmdb}
	E^{\textrm{SM},B_\beta}=\sum_{\mu\nu}D_{\mu\nu}\underbrace{\frac{\iu}{2c}\sum_l^{N_{\textrm{SL}}}\int\left(\vec{R}_{\mu\nu}\times\vec{r}\right)\frac{q_l\chi_\mu^{\vec{B}=0}\chi_\nu^{\vec{B}=0}}{\vert\vec{t}_l-\vec{r}\vert}\diff\vec{r}}_{V_{\mu\nu}^{\textrm{SM},B_\beta}}.
	\end{equation}
	
	\subsection{Implementierung}
	Bei genauer Betrachtung von Gleichung (\ref{eq:esmdb}) fällt auf, dass die $V_{\mu\nu}^{\textrm{SM},B_\beta}$ die selbe Form haben wie die nach den Komponenten des Magnetfeldes abgeleitete Kern-Elektron-Wechselwirkung $V_{\textrm{Ke}\mu\nu}^{B_\beta}$. Zur Implementierung der \ac{cosmo} Beiträge bei der Berechnung chemischer Abschirmungskonstanten können daher die bereits bestehenden Routinen zur Berechnung des letztgenannten Beitrages modifiziert werden. Es ist dabei lediglich darauf zu achten, dass anstelle der Kernladungen die \textit{screening}-Ladungen und anstelle der Kernpositionen die Positionen der \textit{screening}-Ladungen an die entsprechende Routine übergeben werden. In der bei der Verwendung von \ac{cosmo} zur Berechnung von chemischen Abschirmungskonstanten wird daher die Routine \texttt{vsints} ein weiteres Mal von der Routine \texttt{csplop} mit den entsprechenden Feldern gerufen. 
	
Grundsätzlich lassen sich auf diese Weise die Beiträge von beliebige Punktladungen berechnen. Anstelle von \ac{cosmo}, was Punktladungen auf einer Hülle um das gelöste Molekül generiert, besteht daher auch die Möglichkeit die elektrostatische Wechselwirkung expliziter Lösungsmittelmoleküle durch Punktladungen zu ersetzen. Dafür können einzelne Momentaufnahmen aus \ac{md}-Simulationen verwendet werden. An die Positionen der Atome der Lösungsmittel werden Punktladungen gesetzt. Der Betrag der jeweiligen Ladung kann beispielsweise durch eine Populationsanalyse wie Mulliken oder \ac{nbo} bzw. durch einen \ac{esp}-Fit für das isolierte Lösungsmittelmolekül bestimmt werden. Die entsprechenden Koordinaten und Ladungen werden schließlich wieder an die Routine \texttt{vsints} übergeben. Eine Alternative zu den Punktladungen sind gaußförmig verschmierte Ladungen. Die dafür notwendigen Dreizentrenintegrale wurden bereits für die \ac{ri}-Näherung benötigt und können wiederverwendet werden. Um dies zu gewährleisten wird die Routine \texttt{csonei} um einen Aufruf der Routine \texttt{cslp3} erweitert. Im Vergleich zu punktförmigen Ladungen lässt sich dadurch eine etwas weichere Ladungsverteilung generieren. 

Die unterschiedlichen Möglichkeiten zur Einbeziehung von Lösungsmitteleffekten wurden am Beispiel des Acetonmoleküls in Wasser untersucht und ist im folgenden Kapitel erläutert.
	\subsection{Testrechnungen}\label{lömitest}
	
\section{Skalar-relativistische Effekte durch effektive Kernpotentiale}
	\subsection{Theorie}
	\subsection{Implementierung}
	
\section{Berechnung von Vibrational Circular Dichroism Spektren}
	\subsection{Theorie}
	Die im Experiment gemessenen Intensitäten der \ac{vcd}-Spektroskopie $I_n$ sind proportional zu den in quantenchemischen Rechnungen zugänglichen Rotationsstärken $R_n$. Letztere werden aus dem Skalaprodukt vom \textcolor{myred}{elektrischen/\-elektronischen} und vom magnetischen Übergangsdipolmoment, $\vec{\mu}_n^{\,\text{el}}$ und $\vec{\mu}_n^{\,\text{mag}}$,  erhalten. Somit ergibt sich die \ac{vcd}-Intensität
	\begin{equation}
	  I_n\approx R_n = Im(\vec{\mu}_n^{\,\text{el}}\cdot\vec{\mu}_n^{\text{\,mag}})
	\end{equation}
	für einen Übergang aus dem Schwingungsgrundzustand in den angeregten Schwingungszustand $n$.\supercite{stephens1985theory,stephens1985vibrational} Im Rahmen der harmonishen Näherung sind das \textcolor{myred}{elektrische/\-elektronische} und das magnetische Übergangsdipolmoment gegeben durch \textcolor{myred}{(Zitat?)}
	
	\begin{equation}
	  (\mu_n^{\text{el}})_\beta=\sqrt{\frac{\hbar}{\omega_n}}\sum_{K\alpha}P_{\alpha\beta}^K S_{K\alpha,n}
	\end{equation}
	\begin{equation}
	  (\mu_n^{\text{mag}})_\beta=-\sqrt{2\hbar^3\omega_n}\sum_{K\alpha}M_{\alpha\beta}^KS_{K\alpha,n}.
	\end{equation}
	Hierbei ist $I$ die Zählvariable für die Atomkerne, $\alpha$ und $\beta$ beschreiben kartesische Koordinaten, $\omega_n$ ist die Schwingungsfrequenz der $n$-ten Schwingung und $S_{I\alpha,n}$ ist die Transformationsmatrix von kartesichen zu Normalkoordinaten. Sowohl der sogenannte \ac{apt} (Gleichung (\ref{eq:apt}) als auch der sogenannte \ac{aat} (Gleichung (\ref{eq:aat})) lassen sich in einen elektronischen und einen Kernbeitrag aufteilen
	\begin{equation}\label{eq:apt}
	  P^K_{\alpha\beta}=E^K_{\alpha\beta}+N^K_{\alpha\beta}
	\end{equation}
	\begin{equation}\label{eq:aat}
   	  M^K_{\alpha\beta}=I^K_{\alpha\beta}+J^K_{\alpha\beta}.
	\end{equation}
	Die Berechnung der Kernbeiträge 
	\begin{equation}
	  N^K_{\alpha\beta}=eZ_K\delta_{\alpha\beta}
	\end{equation}
	\begin{equation}
	  J^K_{\alpha\beta}=\iu\frac{eZ_K}{4\hbar c}\sum_K^{N_K}\varepsilon_{\alpha\beta\gamma}R^0_{K\gamma}
	\end{equation}
	ist trivial. $e$ ist die Elementarladung, $Z_K$ ist die Ladung des Kerns $K$ und $\delta_{\alpha\beta}$ ist das Kroneckerdelta. $c$ ist die Lichtgeschwindigkeit und $\varepsilon_{\alpha\beta\gamma}$ ist der Levi-Civita-Permutationstensor. Die Position des Kerns $K$ ist durch $R^0_{K\gamma}$ gegeben, wobei $\gamma$ für eine der drei kartesischen Raumkoordinaten steht und die hochgestellte $0$ symbolisiert die Auswertung in der Gleichgewichtsgeometrie.   
	
    Zur Berechnung der elektronischen Beiträge 
    \begin{equation}
      E^K_{\alpha\beta}=\left(\sum_{i=1}^{N_{\text{occ}}}\frac{\partial \langle\phi_i\vert r_\beta\vert\phi_i\rangle}{\partial R_{K\alpha}}\right)_{\vec{R}^0}
    \end{equation}
    \begin{equation}\label{eq:vcdaatel}
      I^K_{\alpha\beta}=\sum_{i=1}^{N_{\text{occ}}}=\left\langle\left.\left(\frac{\partial \phi_i}{\partial R_{K\alpha}}\right)_{\vec{R}^0}\right|\left(\frac{\partial \phi_i}{\partial B_\beta}\right)_{\vec{B}=0}\right\rangle
    \end{equation}
    
    ist ein deutlich größerer Aufwand erforderlich. Die $\phi_i$ sind die besetzten \acp{mo}. Wie bereits in Kapitel \ref{theo:nmr} beschrieben, lasst sich die \ac{mo}-Ableitung nach einer Komponente des externen magnetischen Feldes im Rahmen des \ac{cphf}-Formalismus als 
    \begin{equation}\label{eq:vcdcphf}
    \left(\frac{\partial \phi_i}{\partial B_\beta}\right)_{\vec{B}=0}=\phi_i^{B_\beta}=\sum_{\mu=1}^{N_{\text{BF}}}\left[c_{\mu i}\chi_\mu^{B_\beta}+\sum_{p=1}^{N_{\text{MO}}}c_{\mu p}U_{ip}^{B_\beta}\chi_\mu\right]
	\end{equation}
	ausdrücken. Die Koeffizientenmatrix $U_{ip}^{B_\beta}$ beschreibt die Änderung der Molekülorbitale durch die Störung des äußeren Magnetischen Feldes $\vec{B}$. Sie wird durch Lösen der entsprechenden \ac{cphf}-Gleichungen erhalten, ganz analog zur Vorgehensweise bei der Berechnung von \ac{nmr}-Abschirmkonstanten. Durch die Kombination der Gleichungen (\ref{eq:vcdaatel}) und  (\ref{eq:vcdcphf}) wird der zu implementierende Ausdruck für den elektronischen Anteil des \ac{aat} erhalten
	\begin{equation}\label{eq:vcdaatelfinal}
	\begin{aligned}
	I^K_{\alpha\beta}=&\sum_{i=1}^{N_{\text{occ}}}\sum_{\mu,\nu=1}^{N_{\text{BF}}}\left[c_{\mu i}c_{\nu i}\left\langle\chi_\mu^{R_{K\alpha}}\vert\chi_\nu^{B_\beta}\right\rangle+\sum_{p=1}^{N_{\text{MO}}}c_{\mu i}c_{\nu p}U_{ip}^{B_\beta}\left\langle\chi_\mu^{R_{K\alpha}}\vert\chi_\nu\right\rangle\right.\\
	&\left.+\sum_{p=1}^{N_{\text{MO}}}c_{\mu i}c_{\nu p}U_{ip}^{R_{K\alpha}}\left\langle\chi_\mu\vert\chi_\nu^{B_{\beta}}\right\rangle+\sum_{p,q=1}^{N_{\text{MO}}}c_{\mu p}c_{\nu q}U_{ip}^{R_{K\alpha}}U_{iq}^{B_\beta}\left\langle\chi_\mu\vert\chi_\nu\right\rangle\right].
	\end{aligned}
	\end{equation}
	Durch die Koeffizientenmatrix $U_{ip}^{R_{K\alpha}}$ wird die Response der Wellenfunktion auf die Verrückung des Kerns $K$ beschrieben. Analog zu $U_{ip}^{B_\beta}$ werden auch sie durch Lösen der entsprechenden \ac{cphf}-Gleichungen erhalten. Gebraucht werden sie ebenfalls zur Berechnung von Kraftkonstanten, wie sie im \textsf{Turbomole} Modul \texttt{aoforce}\supercite{deglmann2002efficient} berechnet werden.
	\subsection{Implementierung}
	Die in Gleichung (\ref{eq:vcdaatelfinal}) auftretenden Integrale, welche die Ableitung nach dem externen magnetischen Feld enthalten, lassen sich für die $x$-Komponente des $B$-Feldes wie folgt umschreiben
	
	\begin{equation}
	\begin{aligned}
	  \left\langle\chi_\mu\vert\chi_\nu^{B_x}\right\rangle&=\left.\left\langle\chi_\mu\left|\frac{\partial}{\partial B_x}\right.\chi_\nu\right\rangle\right|_{\vec{B}=0}=\left\langle\chi_\mu^{\vec{B}=0}\left|\frac{-\iu}{2c}\left(R_{\nu y}z-R_{\nu z}y\right)\right|\chi_\nu^{\vec{B}=0}\right\rangle\\
	  &=\frac{\iu}{2c}\left(R_{\nu z}\left\langle\chi_\mu^{\vec{B}=0}\left|y\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu y}\left\langle\chi_\mu^{\vec{B}=0}\left|z\right|\chi_\nu^{\vec{B}=0}\right\rangle\right).
	\end{aligned}
	\end{equation}
	
	Analog ergeben sich die Ableitungen nach der $y$- 
	
		\begin{equation}
	  \left\langle\chi_\mu\vert\chi_\nu^{B_y}\right\rangle=\frac{\iu}{2c}\left(R_{\nu x}\left\langle\chi_\mu^{\vec{B}=0}\left|z\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu z}\left\langle\chi_\mu^{\vec{B}=0}\left|x\right|\chi_\nu^{\vec{B}=0}\right\rangle\right)
	\end{equation}
	
	und $z$-Komponente
	
		\begin{equation}
	  \left\langle\chi_\mu\vert\chi_\nu^{B_z}\right\rangle=\frac{\iu}{2c}\left(R_{\nu y}\left\langle\chi_\mu^{\vec{B}=0}\left|x\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu x}\left\langle\chi_\mu^{\vec{B}=0}\left|y\right|\chi_\nu^{\vec{B}=0}\right\rangle\right).
	\end{equation}

\section{meta-GGA Funktionale}
	\subsection{Theorie}
	\subsection{Implementierung}
	
	