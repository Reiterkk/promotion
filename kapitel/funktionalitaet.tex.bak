Das Modul \texttt{mpshift} umfasste bisher die Möglichkeit der Berechnung von Abschirmungskonstanten in Molekülen ohne schwere Elemente (bis etwa $Z$=36) in der Gasphase. Diese Berechnungen konnten auf Hartree-Fock-, \ac{dft}- (für \ac{lda}- und \ac{gga}-Funktionale) und \ac{mp2}-Niveau durchgeführt werden. Des Weiteren konnte die nach den Komponenten des Magnetfeldes abgeleitete Dichtematrix dem eigenständigen Programm \ac{gimic} zur Weiterverarbeitung bereitgestellt werden. Die folgenden Abschnitte beschreiben die Erweiterungen der Funktionalität des Moduls, welche im Rahmen dieser Arbeit implementiert werden, um sie im Anschluss daran zur Beantwortung chemischer Fragestellungen anzuwenden. Im Einzelnen sind dies die Einbeziehung von Umgebungseffekten, die Berücksichtigung relativistischer Effekte auf Nachbaratome in Molekülen mit schweren Elementen durch die Verwendung relativistischer \acp{ecp} sowie die Bereitstellung der magnetischen Response zur Berechnung von \ac{vcd}-Spektren. Weiterhin wurde das Modul um die Möglichkeit ergänzt, \ac{mgga}-Funktionale für die Berechnung der Abschirmungskonstanten auf \ac{dft}-Niveau zu verwenden. Die Implementierung dieses letzten Punktes erfolgte gemeinsam mit Fabian Mack im Rahmen seiner Masterarbeit.\supercite{mack2017} 


\section{Berücksichtigung von Umgebungseffekten}\label{umgebung}
Isotrope chemische Verschiebungen werden üblicherweise in Lösung gemessen. Je nachdem wie stark das zu untersuchende Molekül mit dem Lösungsmittel wechselwirkt, hat das Lösungsmittel einen mehr oder weniger stark ausgeprägten Einfluss auf das gemessene Spektrum. Das \acf{cosmo},\supercite{klamt1993cosmo} ein Kontinuumsmodell, ist in der Quantenchemie ein bewährtes Verfahren zur Berücksichtigung von Umgebungseffekten. Neben den Einflüssen des Lösungsmittels lassen sich damit auch die Ladungen von Ionen  kompensieren, ohne die Gegenionen explizit in die Berechnung einbeziehen zu müssen. Insbesondere hoch geladene Anionen lassen sich ohne eine solche Ladungskompensation nur schwer oder gar nicht berechnen. 

Neben \ac{cosmo} besteht auch die Möglichkeit, Lösungsmittelmoleküle explizit in die Berechnung einzubeziehen. Soll eine größere Anzahl an Lösungsmittelmolekülen explizit betrachtet werden, um beispielsweise eine vollständige Solvatationshülle um das gelöste Molekül zu erhalten, bieten sich \aclu*{md-}\mbox{(\acs{md}-)}\acused{md}Simulationen an. Hierbei wird eine Simulation für die Dauer eines vom Nutzer spezifizierten Zeitintervalls durchgeführt. Aus einzelnen Momentaufnahmen dieser Simulation lassen sich die Molekülkoordinaten extrahieren. Für diese ausgewählten Koordinaten können anschließend \textit{ab initio} Rechnungen durchgeführt werden. Ein Vergleich solch unterschiedlicher Ansätze ist in Abschnitt \ref{lömitest} für das Acetonmolekül in Wasser zu finden. 

	\subsection{Theorie}\label{kap:cosmotheo}
	In einem Kontinuum-Lösungsmittel-Model (englisch \ac{csm}), wie dem \ac{cosmo}, wird das zu betrachtende Lösungsmittel durch seine relative Permittivität $\varepsilon$ beschrieben. Das gelöste Molekül stellt dabei einen Hohlraum im dielektrischen Kontinuum dar und polarisiert das dielektrische Medium aufgrund seiner Ladungsverteilung. Zur Beschreibung der Reaktion des dielektrischen Mediums auf diese Polarisierung, werden auf der Oberfläche des durch das gelöste Molekül entstandenen Hohlraums sogenannte \textit{screening}-Ladungen generiert. In der Praxis wird also in einem bestimmten Abstand eine Hülle um das gelöste Molekül gelegt und auf der Oberfläche dieser Hülle befinden sich diese Ladungen. Beim \ac{cosmo} wird nun die Nebenbedingung eingeführt, dass das elektrostatische Potential auf der Oberfläche dieser Hülle verschwinden soll, was einem idealen Lösungsmittel mit unendlicher relativer Permittivität $\varepsilon=\infty$ entspricht. Das gesamte elektrostatische Potential $\vec{\phi}^{\,\textrm{Tot}}$ setzt sich aus dem Beitrag des gelösten Moleküls $\vec{\phi}^{\,\textrm{Mol}}$ und dem Beitrag der \textit{screening}-Ladungen $\boldsymbol{A}\vec{q}$ zusammen. $\vec{\phi}^{\,\textrm{Mol}}$ beinhaltet dabei sowohl die Beiträge der Elektronen als auch die der Kerne. Der Vektor $\vec{q}$ enthält die insgesamt $N_{\textrm{SL}}$ \textit{screening}-Ladungen und die Matrix $\boldsymbol{A}$ beinhaltet die Coulombwechselwirkung der \textit{screening}-Ladungen untereinander. Mit der Bedingung des verschwindenden elektrostatischen Potentials folgt daher
	\begin{equation}
	\vec{\phi}^{\,\textrm{Tot}}=\vec{\phi}^{\,\textrm{Mol}}+\boldsymbol{A}\vec{q}=0\, ,
	\end{equation}
	
wodurch sich die \textit{screening}-Ladungen definieren lassen,
	\begin{equation}
	\vec{q}=\boldsymbol{A}^{-1}\vec{\phi}^{\,\textrm{Mol}}\, .
	\end{equation}
	
Um nun Lösungsmittel mit unterschiedlichen relativen Permittivitäten betrachten zu können, wird der Skalierungsfaktor 
	\begin{equation}
	f(\varepsilon)=\frac{\varepsilon-1}{\varepsilon+\frac{1}{2}}
	\end{equation}
	
eingeführt und damit lassen sich die entsprechenden \textit{screening}-Ladungen $\vec{q}(\varepsilon)$ in Abhängigkeit von $\varepsilon$ erhalten,
	\begin{equation}
	\vec{q}(\varepsilon)=\vec{q}(\varepsilon=\infty)f(\varepsilon)\, .
	\end{equation}
	
Die Abweichungen aufgrund der hier gewählten Nebenbedingung des verschwindenden elektrostatischen Potentials, im Vergleich zu den eigentlich viel komplexeren Nebenbedingungen, ist sehr gering.\supercite{klamt1993cosmo} Dies gilt insbesondere für Lösungsmittel mit großen relativen Permittivitäten, wie beispielsweise Wasser.

Bei der Berechnung der Abschirmungskonstanten müssen die erzeugten Punktladungen auf der Oberfläche der Hülle um das gelöste Molekül ebenfalls berücksichtigt werden, um konsistente Resultate zu erhalten. Die \textit{screening}-Ladungen ergeben einen zusätzlichen Energiebeitrag $E^{\textrm{SM}}$ für den Einelektronen-Teil,\supercite{cammi1999nuclear}
	\begin{equation}\label{eq:esm}
	E^{\textrm{SM}}=\sum_{l}^{N_{\textrm{SL}}}\int\frac{q_l\rho(\vec{r})}{\vert\vec{t}_l-\vec{r}\vert}\Diff3\vec{r}=\sum_{\mu\nu}D_{\mu\nu}\underbrace{\sum_l^{N_{\textrm{SL}}}\int\frac{q_l\chi_\mu^*\chi_\nu}{\vert\vec{t}_l-\vec{r}\vert}\Diff3\vec{r}}_{V_{\mu\nu}^{\textrm{SM}}}
	\end{equation}
	
mit den Positionen $\vec{t}_l$ der \textit{screening}-Ladungen. Für die Abschirmungskonstanten wird daher die Ableitung von Gleichung (\ref{eq:esm}) nach den Komponenten des Magnetfeldes benötigt. Dies führt schließlich zu
	\begin{equation}\label{eq:esmdb}
	E^{\textrm{SM},B_\beta}=\sum_{\mu\nu}D_{\mu\nu}\underbrace{\frac{\iu}{2c}\sum_l^{N_{\textrm{SL}}}\int\left(\vec{R}_{\mu\nu}\times\vec{r}\right)\frac{q_l\chi_\mu^{\vec{B}=0}\chi_\nu^{\vec{B}=0}}{\vert\vec{t}_l-\vec{r}\vert}\Diff3\vec{r}}_{V_{\mu\nu}^{\textrm{SM},B_\beta}}\, ,
	\end{equation}

was bedeutet, dass lediglich die zuvor in einer \ac{scf}-Rechnung ermittelten \textit{screening}-Ladungen -- in Form von Punktladungen -- in die Berechnung eingehen.  
	
	\subsubsection{Direct COSMO-RS}
Als einfaches Kontinuumsmodell behandelt \ac{cosmo} Umgebungseffekte auf rein elektrostatischer Ebene. Um die Limitierungen dieses Ansatzes zu verringern, kann das \ac{dcosmors}\supercite{sinnecker2006calculation,klamt2011cosmo,renz2012reliable} angewendet werden. Diesem liegt das \ac{cosmors}\supercite{klamt1995conductor,klamt1998refinement} zugrunde, das die Wechselwirkung zwischen Lösungsmittel und gelöstem Stoff mithilfe eines statistischen thermodynamischen Ansatzes beschreibt und daher die Berechnung thermodynamischer Eigenschaften von Flüssigkeiten ermöglicht. Es basiert auf \ac{cosmo}-\ac{scf}-Rechnungen der Moleküle in einem elektrischen Leiter, d.\,h. $\varepsilon=\infty$. Auf diese Weise lässt sich sowohl das gelöste Molekül als auch das Lösungsmittel auf demselben quantenchemischen Level berechnen. Dadurch können Wasserstoffbrücken, Lösungsmittelgemische oder Temperatureffekte beschrieben werden.\supercite{renz2012reliable} Im \ac{dcosmors}-Ansatz werden nun sogenannte $\sigma$-Potentiale verwendet. Diese lösungsmittelspezifischen Response-Funktionen werden zuvor in einer \ac{cosmors}-Rechnung mit dem COSMOtherm-Programmpaket\supercite{cosmotherm,eckert2002fast} bestimmt. Standardmäßig wird dabei das Funktional BP86\supercite{perdew1986density,becke1988density} sowie die def-TZVP-Basis\supercite{schafer1994fully} verwendet. Der Einfluss des \ac{dcosmors}-Ansatzes resultiert in einer Korrektur der \ac{cosmo}-Ladungen $q_l^{\Delta \textrm{RS}}$. \supercite{sinnecker2006calculation} Damit ist das vollständige Lösungsmittelpotential gegeben durch

\begin{equation}
V_{\mu\nu}^{\textrm{RS}}=\sum_l^{N_{\textrm{SL}}}\int\frac{\left(q_l+q_l^{\Delta \textrm{RS}}\right)\chi_\mu\chi_\nu}{\vert\vec{t}_l-\vec{r}\vert}\Diff3\vec{r}\, .
\end{equation}
	 
	\subsection{Implementierung}\label{kap:cosmoimp}
	Bei Betrachtung von Gleichung (\ref{eq:esmdb}) ist zu sehen, dass die $V_{\mu\nu}^{\textrm{SM},B_\beta}$ dieselbe Form haben wie die nach den Komponenten des Magnetfeldes abgeleitete Kern-Elektron-Wechselwirkung $V_{\textrm{Ke},\mu\nu}^{B_\beta}$ (Gleichung \ref{eq:vmunudb}). Für die Implementierung der \ac{cosmo}-Beiträge zur Berechnung der Abschirmungskonstanten können daher die bereits bestehenden Routinen zur Berechnung des letztgenannten Beitrages modifiziert werden. Es ist dabei lediglich darauf zu achten, dass anstelle der Kernladungen die \textit{screening}-Ladungen und anstelle der Kernpositionen die Positionen der \textit{screening}-Ladungen an die entsprechende Routine übergeben werden. Bei der Verwendung von \ac{cosmo} zur Berechnung von Abschirmungskonstanten wird daher die Routine \texttt{vsints} ein weiteres Mal von der Routine \texttt{csplop} mit den entsprechenden Feldern gerufen. Für die Implementierung zur Berechnung der Abschirmungskonstanten mit \ac{dcosmors} ändert sich an dieser Stelle nichts. Anstelle der normalen \ac{cosmo}-Ladungen $\vec{q}(\varepsilon)$ müssen nur die \ac{dcosmors}-Ladungen $\vec{q}(\varepsilon)+\vec{q}^{\,\Delta\textrm{RS}}$ der Routine \texttt{vsints} übergeben werden.
	
Grundsätzlich lassen sich auf diese Weise die Beiträge von beliebige Punktladungen berechnen. Anstelle von \ac{cosmo}, welches Punktladungen auf einer Hülle um das gelöste Molekül generiert, besteht daher auch die Möglichkeit, die elektrostatische Wechselwirkung expliziter Lösungsmittelmoleküle durch die Wechselwirkung mit Punktladungen zu ersetzen. Dafür können einzelne Momentaufnahmen aus \ac{md}-Simulationen verwendet werden. An die Atompositionen der Lösungsmittelmoleküle werden Punktladungen gesetzt. Der Betrag der jeweiligen Ladung kann beispielsweise durch eine Populationsanalyse wie Mulliken\supercite{mulliken1955electronic} oder \ac{npa}\supercite{reed1985natural} bzw. durch einen elektrostatischen Potential (\acs{esp})-Fit\supercite{singh1984approach} für das isolierte Lösungsmittelmolekül bestimmt werden. Die entsprechenden Koordinaten und Ladungen werden schließlich wieder an die Routine \texttt{vsints} übergeben. Eine Alternative zur Berechnung der Umgebungseffekte mit Punktladungen sind gaußförmig verschmierte Ladungen. Die dafür notwendigen Dreizentren-Integrale werden bereits für die \ac{ri}-Näherung benötigt, welche ausführlich in Abschnitt \ref{ri} beschrieben wird, und können an dieser Stelle wiederverwendet werden. Um dies zu gewährleisten wird die Routine \texttt{csonei} um einen Aufruf der Routine \texttt{cslp3\_omp} (s.u.) erweitert. Im Vergleich zu punktförmigen Ladungen lässt sich dadurch eine etwas weichere Ladungsverteilung generieren. 

Die unterschiedlichen Möglichkeiten zur Einbeziehung von Lösungsmitteleffekten werden am Beispiel des Acetonmoleküls in Wasser untersucht und sind im folgenden Abschnitt erläutert.
	
	\subsection{Testrechnungen}\label{lömitest}
	\subsubsection{Aceton in Wasser}
	Als Beispiel für Lösungsmitteleffekte auf die chemische Verschiebung wurden die Solvatationsverschiebungen im Acetonmolekül beim Übergang von der Gasphase in eine wässrige Lösung untersucht. Die experimentellen Verschiebungen für diesen Übergang betragen \unit[75.5]{ppm} für das Sauerstoffatom\supercite{cossi2003different} und \unit[$-$18.9]{ppm} für das Carbonyl-Kohlenstoffatom\supercite{tiffon1978effet}. Neben dem einfachen Ansatz von \ac{cosmo} und \ac{dcosmors} wurden zusätzlich \ac{md}-Simulationen mit ca. 400 Wassermolekülen durchgeführt und die Koordinaten aller Atome aus 100 Momentaufnahmen extrahiert. Mit diesen Koordinaten kann nun folgendermaßen verfahren werden. Im einfachsten Fall können die Atome aller Wassermoleküle durch Punktladungen genähert werden. Die Ladungen wurden dabei mithilfe eines \acs{esp}-Fits für ein isoliertes Wassermolekül bestimmt. Als Alternative zu den Punktladungen können auch gaußförmig verschmierte Ladungen verwendet werden, welche für einen etwas weicheren Ladungsübergang sorgen. Ein anderer Ansatz stellt das explizite Berechnen der Wassermoleküle dar. Dafür wurden die dem Acetonmolekül nächstgelegenen 16/32/64 Wassermoleküle bestimmt und bei der Berechnung einbezogen. Schließlich lassen sich diese Methoden auch kombinieren, d.\,h. die innersten Wassermoleküle werden explizit behandelt, während die äußeren lediglich in Form von Punkt- oder gaußförmig verschmierten Ladungen in die Rechnung eingehen. Die Ergebnisse für die mit der def2-SVP-Basis\supercite{weigend2005balanced} und dem PBE-Funktional\supercite{perdew1996generalized} berechneten Solvatationsverschiebungen sind in Abbildung \ref{abb:acinh2o} dargestellt. Eingezeichnete Fehlerbalken beziehen sich auf die Standardabweichung von der Mittelwertbildung über alle ausgewählten Strukturen aus der \ac{md}-Simulation. Der grundsätzliche Trend zeigt bei allen untersuchten Methoden in die richtige Richtung. Bei der expliziten Berücksichtigung der Wassermoleküle lässt sich jedoch keine eindeutige Konvergenz mit der Anzahl explizit berücksichtigter Wassermoleküle erkennen. Im Vergleich zur Solvatationsverschiebung des Sauerstoffatoms liegt die Solvatationsverschiebungen des Carbonyl-Kohlenstoffatoms mit dieser Methode tendenziell etwas näher am experimentellen Wert. Umgekehrt verhält es sich bei der Berechnung mit Punkt- bzw. gaußförmig verschmierten Ladungen, wodurch kein eindeutiger Favorit zwischen den beiden Methoden ausgemacht werden kann. Der wesentlich einfachere \ac{cosmo}-Ansatz führt zu einer ähnlich guten Beschreibung der Solvatationsverschiebungen. Diese werden um ca. \unit[25]{ppm} für das Sauerstoffatom und ca. \unit[9]{ppm} für das Kohlenstoffatom unterschätzt. Deutlich besser verhält sich die \ac{dcosmors}-Rechnung. Diese kommt bis auf \unit[9]{ppm} bzw. \unit[3]{ppm} an die experimentellen Werte heran. 
	\begin{figure}[ht!]
	\centering
	\includegraphics[width=1.0\textwidth]{acinh2o}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Solvatationseffekte für Aceton in Wasser]{\textsf{(a)} Aceton im Zentrum umgeben von 32 explizit in die Wellenfunktion einbezogenen Wassermolekülen (rot-weiß) und einer Solvatationshülle (blau) bestehend aus weiteren Wassermolekülen, welche nicht explizit bei der Berechnung der Abschirmungskonstanten berücksichtigt wurden. Im unteren Bereich sind die Solvatationsverschiebungen mit unterschiedlichen Methoden für das Sauerstoffatom \textsf{(b)} und das Carbonyl-Kohlenstoffatom \textsf{(c)} dargestellt. Die experimentellen Werte wurden den Referenzen \cite{cossi2003different} (Sauerstoff) und \cite{tiffon1978effet} (Kohlenstoff) entnommen. Eingezeichnete Fehlerbalken stellen die Standardabweichung von der Mittelwertbildung über alle ausgewählten Strukturen aus der \ac{md}-Simulation dar.}
\label{abb:acinh2o}
\end{figure}
\FloatBarrier
	\subsubsection{Lösungsmitteleffekte auf \texorpdfstring{$^{13}$C}{13C}-chemische Verschiebungen}
	Wie im letzten Abschnitt erläutert wurde liefert das \ac{dcosmors} eine gute Übereinstimmung mit dem Experiment für die Solvatationsverschiebungen des Acetonmoleküls beim Übergang von der Gasphase in die wässrige Lösung. Aus diesem Grund wurde die Genauigkeit mit \ac{cosmo} und \ac{dcosmors} berechneter Lösungsmitteleffekte auf $^{13}$C-chemische Verschiebungen für die organischen Moleküle in der Tabelle aus Referenz \cite{fulmer2010nmr} weiter untersucht. Die absoluten Abschirmungskonstanten der entsprechenden Kohlenstoffatome in den Lösungsmitteln THF-d$_{8}$, CD$_{2}$Cl$_{2}$, CDCl$_{3}$, Toluol-d$_{8}$, C$_{6}$D$_{6}$, C$_{6}$D$_{5}$Cl, (CD$_{3}$)$_{2}$CO, (CD$_{3}$)$_{2}$SO, CD$_{3}$CN, TFE-d$_{3}$, CD$_{3}$OD und D$_{2}$O sind in der Tabelle \ref{tab:sigmacosmo} für die Berechnung mit \ac{cosmo} und in der Tabelle \ref{tab:sigmacosmors} für die Berechnung mit \ac{dcosmors} im Anhang \ref{anhang} angegeben. Das jeweilige Lösungsmittelmodel wurde dafür sowohl bei der Optimierung der Strukturparameter als auch bei der Berechnung der Abschirmungskonstanten verwendet. Durchgeführt wurden die Berechnungen mit dem Funktional TPSSh\supercite{staroverov2003comparative} und der def2-TZVP-Basis\supercite{weigend2005balanced}. Bei den insgesamt $N_{\textrm{Sol}}$ Lösungsmitteln ergeben sich für jeden betrachteten Kohlenstoff $N_{\textrm{Paar}}=\frac{N_{\textrm{Sol}}(N_{\textrm{Sol}}-1)}{2}$ Paare chemischer Verschiebungen (hier $=66$ für $N_{\textrm{Sol}}=12$), welche mit den experimentellen Paaren verglichen werden können. Der Fehler der berechneten chemischen Verschiebung für jeden dieser Kohlenstoffatome ist durch die Wurzel der gemittelten Fehlerquadrate definiert
	\begin{equation}
	\delta_{\textrm{err}}=\sqrt{\frac{1}{N_{\textrm{Paar}}}\sum_{i=1}^{N_{\textrm{Sol}}}\sum_{j>i}^{N_{\textrm{Sol}}}\left[\left(\delta_{\textrm{calc.},{\textrm{Sol }i}}-\delta_{\textrm{calc.},{\textrm{Sol }j}}\right)-\left(\delta_{\textrm{exp.},{\textrm{Sol }i}}-\delta_{\textrm{exp.},{\textrm{Sol }j}}\right)\right]^2}\, .
	\end{equation}

    Diese Fehler sind für die betrachteten Verbindungen in den beiden Graphen in Abbildung \ref{abb:cosmofehler} dargestellt. Die größten Fehler treten vor allem bei den Carbonyl-Kohlenstoffatomen auf. Erwartungsgemäß schneitet das \ac{dcosmors} hier etwas besser ab als das reine \ac{cosmo}. Im Vergleich mit den restlichen Verbindungen sind jedoch auch hier die Fehler mit am größten. Bis auf wenige Ausreißer verhalten sich \ac{cosmo} und \ac{dcosmors} jedoch weitestgehend ähnlich, sodass kein klarer Favorit zur Berechnung vom Lösungsmitteleffekten ausgemacht werden kann.
   	\begin{figure}[ht!]
	\centering
	\includegraphics[width=1.0\textwidth]{cosmofehler}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[{Fehler von \ac{cosmo} und \ac{dcosmors} für $^{13}$C-chemische Verschiebungen}]{Fehler von \ac{cosmo} und \ac{dcosmors} für die organischen Moleküle aus Referenz \cite{fulmer2010nmr} bei der Berechnung von $^{13}$C-chemischen Verschiebungen.}
	\label{abb:cosmofehler}
	\end{figure} 
\vfill
\FloatBarrier
\newpage
	Alternativ zu den Fehlern einzelner Kohlenstoffatome in den jeweiligen Verbindungen lassen sich auch entsprechende Fehler für die einzelnen Lösungsmittel definieren. Da hierbei die chemischen Verschiebungen unterschiedlicher Systeme verglichen werden, fallen diese Fehler größer aus. Somit ergeben sich unter Berücksichtigung aller Verbindungen Fehler von \unit[10--11]{ppm}, sowohl für \ac{cosmo} als auch für \ac{dcosmors}. Insbesondere die chemischen Verschiebungen der Kohlenstoffatome in den Verbindungen MeCl$_4$, MeHCl$_3$ und MeH$_2$Cl$_2$ werden besonders schlecht beschrieben und liegen weit neben den experimentellen Werten. Jedoch trifft dieses Verhalten auch bereits auf berechnete chemische Verschiebungen dieser Systeme in der Gasphase zu, sodass nicht grundsätzlich eine schlechte Beschreibung der Lösungsmitteleffekte vorliegt. Eine mögliche Ursache für dieses Verhalten könnten Spin-Bahn-Effekte darstellen.\supercite{yannickpers} Unter Vernachlässigung dieser drei Verbindungen ergeben sich die in Abbildung \ref{abb:loemifehler} dargestellten Fehler für die einzelnen Lösungsmittel. Besonders auffällig ist das unerwartet schlechte Abschneiden von \ac{dcosmors} bei der Betrachtung von Wasser und TFE als Lösungsmittel. Insgesamt führen die beiden Methoden jedoch auch hier zu ähnlichen Resultaten.
\vspace{2.0cm}
   	\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.7\textwidth]{loemifehler}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[{Fehler von \ac{cosmo} und \ac{dcosmors} für unterschiedliche Lösungsmittel}]{Fehler von \ac{cosmo} und \ac{dcosmors} für die unterschiedlichen Lösungsmittel aus Referenz \cite{fulmer2010nmr} bei der Berechnung von $^{13}$C-chemischen Verschiebungen. Die Verbindungen MeCl$_4$, MeHCl$_3$ und MeH$_2$Cl$_2$ wurden nicht berücksichtigt.}
	\label{abb:loemifehler}
	\end{figure}    	
\vfil
\newpage
	
\section{Beschreibung skalar-relativistischer Effekte durch effektive Kernpotentiale}\label{kap:ecps}
Für schwere Atome nimmt mit steigender Kernladungszahl der Einfluss relativistischer Effekte zu. Diese relativistischen Einflüsse haben ihren Ursprung in Kernnähe schwerer Atome. Sie übertragen sich jedoch wegen der Orthogonalität der Orbitale auch auf die Valenzschalen der entsprechenden Atome und haben damit ebenfalls einen Einfluss auf die chemische Verschiebung an benachbarten Atomen. Die relativistische Berechnung im Rahmen vier- oder zweikomponentiger Methoden -- wie beispielsweise die Theorie der exakten Entkopplung (englisch \textit{exact two-component decoupling}, X2C)\supercite{liu2010ideas,saue2011relativistic,peng2012exact} -- ist sehr aufwändig. Eine alternative Berücksichtigung skalar-relativistischer Effekte ist durch die Verwendung von sogenannten \acfp{ecp}\supercite{cundari1996effective,frenking2007pseudopotential} gegeben. Hierbei werden die Elektronen in den Rumpforbitalen durch ein entsprechend gefittetes Potential beschrieben und nur die Valenzelektronen explizit betrachtet. Aufgrund der fehlenden kernnahen Elektronen haben Abschirmungskonstanten, welche für Atome mit einem \ac{ecp} berechnet wurden, keine physikalische Bedeutung. Die Rumpfelektronen liefern den größten Beitrag zur Abschirmung und daher wird diese stark unterschätzt. Werden jedoch nur wenige Rumpforbitale durch das \ac{ecp} ersetzt, d.\,h. sogenannte \textit{small}-\textit{core}-\acp{ecp} verwendet, kann bei der Berechnung relativer chemischer Verschiebungen davon ausgegangen werden, dass sich der fehlende kernnahe Beitrag aufhebt.\supercite{van2012use} In diesem Zusammenhang untersuchten Moore und Healy\supercite{moore1995ab} die Abhängigkeit der Titan-Abschirmung in Titan-Tetrahalogeniden von All-Elektronen-Basissätzen sowie \acp{ecp} und kamen zu dem Schluss, dass die absoluten Abschirmungen stark von der gewählten Basis abhängen, die relativen chemischen Verschiebungen jedoch weitgehend unabhängig davon sind. Bagno und Bonchio konnten ebenfalls zeigen, dass sich die chemischen Verschiebungen, berechnet mit \acp{ecp}, von Wolfram\supercite{bagno2000effective} und Ruthenium\supercite{bagno2002dft} gut mit experimentell gemessenen Daten korrelieren lassen. Problematisch ist jedoch, dass die so erhaltenen chemischen Verschiebungen zunächst an experimentell gemessene Verschiebungen gefittet werden müssen, um eine Korrelation herzustellen. Erst damit lassen sich Aussagen über die chemische Verschiebung in unbekannten Verbindungen treffen. Für Atome ohne \acp{ecp} innerhalb eines Moleküls, welches auch Atome mit \acp{ecp} enthält, ist keine Skalierung nötig. In jedem Fall muss allerdings die im Folgenden erläuterte eichinvariante Formulierung verwendet werden.
\vfill
\newpage
	\subsection{Theorie}
	Eine eichinvariante Implementierung für \acp{ecp} wurde von van Wüllen\supercite{van2012use} vorgeschlagen und die wichtigsten darin abgeleiteten Gleichungen sollen an dieser Stelle wiedergegeben werden. 
	
	Der Einelektronen-Hamiltonoperator im Magnetfeld $\vec{B}$ setzt sich aus dem ungestörten Hamiltonoperator $\hat{h}^0$ in Abwesenheit des Magnetfeldes sowie weiteren Termen linear, quadratisch usw. in $\vec{B}$ zusammen. Für die chemische Verschiebung werden jedoch nur Terme linear in $\vec{B}$ benötigt, daher ist $\hat{h}$ an dieser Stelle
	\begin{equation}\label{eq:heinel}
	\begin{aligned}
	\hat{h}=&\hat{h}^0+\hat{h}^{10}\, ,\\
	\hat{h}^0=&\frac{1}{2}\vec{p}^{\,2}+\hat{V}_{\textrm{Ke}}\, ,\\
	\hat{h}^{10}=&\frac{1}{2c}\left(\left(\vec{r}-\vec{R}_E\right)\times\vec{p}\right)\cdot\vec{B}\, .
	\end{aligned}
	\end{equation}
	
	Wie bereits zuvor in Abschnitt \ref{theo:nmr} erwähnt, kannn der Eichursprung willkürlich gewählt werden und der Hamiltonoperator ist genau dann eichinvariant, wenn für unterschiedliche Eichursprünge dieselben Werte magnetischer Eigenschaften berechnet werden. Dies ist dann erfüllt, wenn der Hamiltonoperator $\hat{\tilde{h}}$ mit dem Eichursprung $\vec{R}_{\tilde{E}}$ aus $\hat{h}$ durch eine unitäre Transformation der Form
	\begin{equation}\label{eq:trans}
	\hat{\tilde{h}}=\exp\left(\iu\Lambda_{\tilde{E}}\right)\hat{h}\exp\left(-\iu\Lambda_{\tilde{E}}\right)
	\end{equation}
	
	mit 
	\begin{equation}
	\begin{aligned}
	\Lambda_{\tilde{E}}=&\frac{1}{2c}\left(\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\times\vec{r}\right)\cdot\vec{B}\\
	=&\frac{1}{2c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)\cdot\vec{r}
	\end{aligned}
	\end{equation}
	
	erhalten werden kann. Zur Bestimmung von $\hat{\tilde{h}}$ wird dessen Wirkung auf eine Funktion $f(\vec{r})$ betrachtet. Aus der unitären Transformation folgt:
	\begin{equation}\label{eq:transh}
	\begin{aligned}
	\hat{\tilde{h}}f(\vec{r})=&\exp\left(\iu\Lambda_{\tilde{E}}\right)\hat{h}\exp\left(-\iu\Lambda_{\tilde{E}}\right)f(\vec{r})\\
	=&\exp\left(\iu\Lambda_{\tilde{E}}\right)\hat{h}^0\exp\left(-\iu\Lambda_{\tilde{E}}\right)f(\vec{r})+\exp\left(\iu\Lambda_{\tilde{E}}\right)\hat{h}^{10}\exp\left(-\iu\Lambda_{\tilde{E}}\right)f(\vec{r})\, .
	\end{aligned}
	\end{equation}
	
	Für den ersten Term auf der rechten Seite von Gleichung (\ref{eq:transh}) ergibt sich
	\begin{equation}\label{eq:transh1}
	\begin{aligned}
	&\exp\left(\iu\Lambda_{\tilde{E}}\right)\hat{h}^0\exp\left(-\iu\Lambda_{\tilde{E}}\right)f(\vec{r})\\
	=&\exp\left(\iu\Lambda_{\tilde{E}}\right)\frac{-\iu}{2}\vec{p}\left[\frac{-\iu}{2c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)\exp\left(-\iu\Lambda_{\tilde{E}}\right)f(\vec{r})\right]\\
	&+\exp\left(\iu\Lambda_{\tilde{E}}\right)\frac{1}{2}\vec{p}\left[\exp\left(-\iu\Lambda_{\tilde{E}}\right)\vec{p}\left(f(\vec{r})\right)\right]+\hat{V}_{\textrm{Ke}}f(\vec{r})\\
	=&-\frac{1}{4c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)\vec{p}\left(f(\vec{r})\right)
	-\frac{1}{4c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)\vec{p}\left(f(\vec{r})\right)\\
	&+\frac{1}{2}\vec{p}^{\,2}f(\vec{r})+\hat{V}_{\textrm{Ke}}f(\vec{r})\\
	=&\frac{-1}{2c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)\vec{p}\left(f(\vec{r})\right)+\hat{h}^0f(\vec{r})
	\end{aligned}
	\end{equation}
	
	und für den zweiten Term
	\begin{equation}\label{eq:transh2}
	\begin{aligned}
	&\exp\left(\iu\Lambda_{\tilde{E}}\right)\hat{h}^{10}\exp\left(-\iu\Lambda_{\tilde{E}}\right)f(\vec{r})\\
	=&\frac{1}{2c}\left(\vec{B}\times\left(\vec{r}-\vec{R}_E\right)\right)\cdot\vec{p}\left(f(\vec{r})\right)\\
	&+\frac{1}{2c}\left(\vec{B}\times\left(\vec{r}-\vec{R}_E\right)\right)\cdot\frac{-1}{2c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)f(\vec{r})\\
	=&\hat{h}^{10}f(\vec{r})+\mathcal{O}(\vec{B}^{\,2})\, .
	\end{aligned}
	\end{equation}
	
	Aus den Ergebnissen in den Gleichungen (\ref{eq:transh1}) und (\ref{eq:transh2}) resultiert der Hamiltonoperator
	\begin{equation}
	\begin{aligned}
	\hat{\tilde{h}}=&\hat{h}^0+\hat{h}^{10}-\frac{1}{2c}\left(\vec{B}\times\left(\vec{R}_{\tilde{E}}-\vec{R}_E\right)\right)\vec{p}\\
	=&\hat{h}^0+\frac{1}{2c}\left(\left(\vec{r}-\vec{R}_{\tilde{E}}\right)\times\vec{p}\right)\cdot\vec{B}\, ,
	\end{aligned}
	\end{equation}
	
	wobei die in $\vec{B}$ quadratischen Terme hier erneut weggelassen wurden. Der Eichursprung wird durch die Transformation also von $\vec{R}_E$ auf $\vec{R}_{\tilde{E}}$ verschoben. Bei dieser Herleitung wird davon ausgegangen, dass die Kern-Elektron-Wechselwirkung ein lokales Potential ist und daher nicht mit $\vec{r}$ kommutiert. Dies ist nur gültig, solange keine \acp{ecp} verwendet werden. Im letzteren Fall ist der Einelektronen-Hamiltonoperator aus Gleichung (\ref{eq:heinel}) durch	
	\begin{equation}
	\hat{h}^0=\frac{1}{2}\vec{p}^{\,2}-\sum_K \left(\frac{Z_K^{\textrm{eff}}}{\vec{r}_K}+\hat{V}^{\textrm{ECP},K}\right)
	\end{equation}
	
	gegeben. Die Valenzelektronen, die nicht durch das \ac{ecp} beschrieben werden, erfahren dann nur noch eine verminderte effektive Kernladung $Z_K^{\textrm{eff}}$. Für die \acp{ecp} ist das Potential durch eine Summe atomarer Beiträge geben und diese haben die Form\supercite{mcmurchie1981calculation,cao2010relativistic}
	\begin{equation}\label{eq:ecpotential}
	\hat{V}^{\textrm{ECP},K}=\sum_{l=0}^{\infty}\hat{V}^{\textrm{ECP},K}_l\hat{P}_l^K
	\end{equation}
	
	mit dem Projektionsoperator
	\begin{equation}
	\hat{P}_l^K=\sum_{m=-l}^l\vert lm\rangle\langle lm\vert
	\end{equation}
	
	und den Kugelflächenfunktionen $\vert lm\rangle$. Für $l\geq L$ unterscheiden sich die $\hat{V}^{\textrm{ECP},K}_l$ kaum mehr, wobei $L-1$ die größte, in den Kernorbitalen auftretende Drehimpulsquantenzahl ist. Mit der Annahme $\hat{V}^{\textrm{ECP},K}_l=\hat{V}^{\textrm{ECP},K}_L$ für $l\geq L$ folgt schließlich\supercite{kahn1972ab}
	\begin{equation}
	\hat{V}^{\textrm{ECP},K}=\hat{V}^{\textrm{ECP},K}_{L}+\sum_{l=0}^{L-1}\sum_{m=-l}^l lm\rangle\left[\hat{V}^{\textrm{ECP},K}_{l}-\hat{V}^{\textrm{ECP},K}_{L}\right]\langle lm\vert \, .
	\end{equation}
	
	Die $\hat{V}^{\textrm{ECP},K}_{m}$ lassen sich nun durch eine Linearkombination von Gaußfunktionen, multipliziert mit Potenzen von $\vec{r}$, ausdrücken\supercite{kahn1972ab}
	\begin{equation}
	\hat{V}^{\textrm{ECP},K}_{m}=\sum_jd_{jm}\vec{r}_K^{\,nj}e^{-\zeta_j\vec{r}_K^{\,2}}, \qquad \textrm{für } m=l,L\, ,
	\end{equation}
	wobei die Exponenten $\zeta_j$ und die Koeffizienten $d_{jm}$ an sehr genaue Rechnungen gefittet werden. Der Drehimpuls-Projektionsoperator $\hat{P}_l^K$ in $\hat{V}^{\textrm{ECP},K}$ führt dazu, dass die \acp{ecp} nicht mehr mit $\vec{r}$ und damit nicht mehr mit $\Lambda$ kommutieren. 
	
	Aus dem magnetfeldabhängigen Hamiltonoperator für ein einzelnes Atom $K$, mit dem Eichursprung $\vec{R}_K$ und der Transformation aus Gleichung (\ref{eq:trans}), lässt sich nun der magnetfeldabhängige \ac{ecp}-Hamiltonoperator für eine beliebige Wahl des Eichursprungs ableiten. Es folgt
	\begin{equation}
	\begin{aligned}
	\hat{h}_{\textrm{ECP}}=&\exp\left(\iu\Lambda_K\right)\hat{h}_K\exp\left(-\iu\Lambda_K\right)\\
	=&\hat{h}^0+\left(\hat{h}^{10}+\iu\left[\hat{V}^{\textrm{ECP},K},\Lambda_K\right]\right)+\mathcal{O}(\vec{B}^{\,2})+\dotsc\, 
	\end{aligned}
	\end{equation}
	
	mit
	\begin{equation}
	\Lambda_K=\frac{1}{2c}\left(\left(\vec{R}_K-\vec{R}_E\right)\times\vec{r}\right)\cdot\vec{B}\, .
	\end{equation}
	
	Für Moleküle muss zusätzlich über die Beiträge aller Atome summiert werden, 
	\begin{equation}\label{eq:hecp}
	\begin{aligned}
	&\hat{h}_{\textrm{ECP}}=\hat{h}^0+\hat{h}_{\textrm{ECP}}^{10}\, ,\\
	&\hat{h}_{\textrm{ECP}}^{10}=\hat{h}^{10}+\iu\sum_K\left[\hat{V}^{\textrm{ECP},K},\Lambda_K\right].
	\end{aligned}
	\end{equation}	
	 
	Die zusätzlichen Integrale, die durch den Kommutator in Gleichung (\ref{eq:hecp}) auftreten, lassen sich durch Entwicklung des Integrals $\langle\chi_\mu\vert\hat{h}_{\textrm{ECP}}\vert\chi_\nu\rangle$ und Angabe der Terme linear in $\vec{B}$ erhalten. Da sowohl die Basisfunktionen als auch der Hamiltonoperator vom Magnetfeld abhängen, ergeben sich für die Terme linear in $\vec{B}$  	
	\begin{equation}\label{eq:linearinb}
	\begin{aligned}
	\langle &\chi_\mu^{\vec{B}=0}\vert\hat{h}_{\textrm{ECP}}^{10}+\iu\Lambda_\mu\hat{h}^0-\iu\hat{h}^0\Lambda_\nu\vert\chi_\nu^{\vec{B}=0}\rangle\\
	&=\langle \chi_\mu^{\vec{B}=0}\vert\hat{h}_{\textrm{ECP}}^{10}\vert\chi_\nu^{\vec{B}=0}\rangle+\iu\langle\chi_\mu^{\vec{B}=0}\vert\left(\Lambda_\mu -\Lambda_\nu\right)\hat{h}^0\vert\chi_\nu^{\vec{B}=0}\rangle-\iu\langle\chi_\mu^{\vec{B}=0}\vert\left[\hat{h}^0 ,\Lambda_\nu\right]\vert\chi_\nu^{\vec{B}=0}\rangle\\
    &=\langle \chi_\mu^{\vec{B}=0}\vert\frac{1}{2c}\left(\left(\vec{r}-\vec{R}_\nu\right)\times\vec{p}\right)\cdot\vec{B}\vert\chi_\nu^{\vec{B}=0}\rangle
    +\iu\langle\chi_\mu^{\vec{B}=0}\vert\left(\Lambda_\mu -\Lambda_\nu\right)\hat{h}^0\vert\chi_\nu^{\vec{B}=0}\rangle\\
    &\quad+\iu\sum_K\langle \chi_\mu^{\vec{B}=0}\vert\left[\hat{V}^{\textrm{ECP},K},\Lambda_K-\Lambda_\nu\right]\vert\chi_\nu^{\vec{B}=0}\rangle\, ,
	\end{aligned}
	\end{equation}
	
	wobei der Kommutator	
	\begin{equation}
	\iu\left[\hat{h}^0 ,\Lambda_\nu\right]=\frac{1}{2c}\left(\left(\vec{R}_\nu-\vec{R}_E\right)\times\vec{p}\right)\cdot\vec{B}+\iu\left[\hat{V}^{\textrm{ECP},K} ,\Lambda_\nu\right]
	\end{equation}
	ausgenutzt wurde. Der letzte Term in Gleichung (\ref{eq:linearinb}) ist ein zusätzlicher Term, der im Rahmen des von van Wüllen vorgeschlagenen \ac{ecp}-\ac{giao}-Formalismus auftritt, alle anderen Terme sind bereits bekannt. Anhand der Terme ist zu erkennen, dass all diese Ausdrücke nun nicht mehr vom Eichursprung abhängen, da dieser nur noch in den Differenzen von $\Lambda_K$ und $\Lambda_\nu$ vorkommt. Werden nun alle Terme, die aufgrund der \acp{ecp} entstehen, kombiniert, wird der letztendlich zu implementierende Ausdruck erhalten,	
	\begin{equation}\label{eq:vecpmunu}
	\begin{aligned}
	V_{\mu\nu}^{\textrm{ECP}}=&\iu\sum_K\langle\chi_\mu^{\vec{B}=0}\vert\left(\Lambda_\mu -\Lambda_\nu\right)\hat{V}^{\textrm{ECP},K}\vert\chi_\nu^{\vec{B}=0}\rangle\\
	&+\iu\sum_K\langle \chi_\mu^{\vec{B}=0}\vert\left[\hat{V}^{\textrm{ECP},K},\Lambda_K-\Lambda_\nu\right]\vert\chi_\nu^{\vec{B}=0}\rangle\\
	=&\iu\sum_K\langle\chi_\mu^{\vec{B}=0}\vert\left(\Lambda_\mu -\Lambda_K\right)\hat{V}^{\textrm{ECP},K}-\hat{V}^{\textrm{ECP},K}\left(\Lambda_\nu -\Lambda_K\right)\vert\chi_\nu^{\vec{B}=0}\rangle \, .
	\end{aligned}
	\end{equation}

	\newpage
	
	\subsection{Implementierung}
	Zur Implementierung der \ac{ecp}-Beiträge für die Berechnung der Abschirmungskonstanten muss Gleichung (\ref{eq:vecpmunu}) nach den Komponenten des Magnetfeldes abgeleitet werden. Die Ableitung von Gleichung (\ref{eq:vecpmunu}) nach der $x$-Komponente ergibt
	\begin{equation}\label{eq:vecpdbx}
	\begin{aligned}
	V_{\mu\nu}^{\textrm{ECP},B_x}=&\left.\frac{\partial V_{\mu\nu}^{\textrm{ECP}}}{\partial B_x}\right\vert_{\vec{B}=0}\\
	=&\frac{\iu}{2c}\sum_K\left[\left\langle\chi_\mu^{\vec{B}=0}\left\vert\left(\left(R_{\mu y}-R_{Ky}\right)z-(\left(R_{\mu z}-R_{Kz}\right)y\right)\hat{V}^{\textrm{ECP},K}\right.\right.\right.\\
	&\left.\left.\left.-\hat{V}^{\textrm{ECP},K}\left(\left(R_{\nu y}-R_{Ky}\right)z-(\left(R_{\nu z}-R_{Kz}\right)y\right)\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right]\\
	=&\frac{\iu}{2c}\sum_K\left[\left(R_{\mu y}-R_{Ky}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert z\hat{V}^{\textrm{ECP},K}\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right.\\
	&-\left(R_{\mu z}-R_{Kz}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert y\hat{V}^{\textrm{ECP},K}\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\\
	&-\left(R_{\nu y}-R_{Ky}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^{\textrm{ECP},K} z\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\\
	&\left.+\left(R_{\nu z}-R_{Kz}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^{\textrm{ECP},K} y\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right]
	\end{aligned}
	\end{equation}
	
	und die analogen Ausdrücke für die Ableitungen nach den $y$- und $z$- Komponenten des Magnetfeldes sind 
	\begin{equation}\label{eq:vecpdby}
	\begin{aligned}
	V_{\mu\nu}^{\textrm{ECP},B_y}=&\frac{\iu}{2c}\sum_K\left[\left(R_{\mu z}-R_{Kz}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert x\hat{V}^{\textrm{ECP},K}\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right.\\
	&-\left(R_{\mu x}-R_{Kx}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert z\hat{V}^{\textrm{ECP},K}\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\\
	&-\left(R_{\nu z}-R_{Kz}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^{\textrm{ECP},K}x\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\\
	&\left.+\left(R_{\nu x}-R_{Kx}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^{\textrm{ECP},K} z\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right]
	\end{aligned}
	\end{equation}
	
	und 
	\begin{equation}\label{eq:vecpdbz}
	\begin{aligned}
	V_{\mu\nu}^{\textrm{ECP},B_z}=&\frac{\iu}{2c}\sum_K\left[\left(R_{\mu x}-R_{Kx}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert y\hat{V}^{\textrm{ECP},K}\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right.\\
	&-\left(R_{\mu y}-R_{Ky}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert x\hat{V}^{\textrm{ECP},K}\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\\
	&-\left(R_{\nu x}-R_{Kx}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^{\textrm{ECP},K}y\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\\
	&\left.+\left(R_{\nu y}-R_{Ky}\right)\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^{\textrm{ECP},K} x\right\vert\chi_\nu^{\vec{B}=0}\right\rangle\right].
	\end{aligned}
	\end{equation} 
	
	Erneut wird an dieser Stelle die Beziehung $\vec{r}=\vec{R}_\mu+\vec{r}_\mu$ ausgenutzt, um die Integrale in den Gleichungen (\ref{eq:vecpdbx})-(\ref{eq:vecpdbz}) umzuschreiben. Beispielsweise ist 
	\begin{equation}\label{eq:ecpintegral}
	\left\langle\chi_\mu^{\vec{B}=0}\left\vert z\hat{V}^K\right\vert\chi_\nu^{\vec{B}=0}\right\rangle=R_{\mu z}\left\langle\chi_\mu^{\vec{B}=0}\left\vert \hat{V}^K\right\vert\chi_\nu^{\vec{B}=0}\right\rangle+\left\langle\chi_\mu^{\vec{B}=0}\left\vert z_\mu\hat{V}^K\right\vert\chi_\nu^{\vec{B}=0}\right\rangle.
	\end{equation}
	
	Das erste Integral auf der rechten Seite von Gleichung (\ref{eq:ecpintegral}) ist ein gewöhnliches \ac{ecp}-Integral. Beim zweiten Integral wurde die $z$-Komponente der Drehimpulsquantenzahl für die Basisfunktion $\chi_\mu^{\vec{B}=0}$ um 1 erhöht, da
	\begin{equation}
	\chi_\mu^{\vec{B}=0}z_\mu=x_\mu^ly_\mu^mz_\mu^{n+1}e^{-\zeta\vec{r}^{\, 2}_\mu}\, .
	\end{equation}
	
	Diese Art von Integralen werden mit einem anderen Vorfaktor auch für die Berechnung der kartesischen \ac{ecp}-Gradienten benötigt. Für die \ac{ecp}-Beiträge zu den Abschirmungskonstanten können also die gewöhnlichen \ac{ecp}-Integral- und \ac{ecp}-Gradientenroutinen modifiziert werden. Dafür werden nun bei der Verwendung von \acp{ecp} zusätzlich die Routinen \texttt{cvw\_ecp\_int} und \texttt{cvw\_ecp\_grad} aufgerufen. Das Zusammensetzen der aufgrund des Kreuzproduktes resultierenden Beiträge in den Gleichungen (\ref{eq:vecpdbx})--(\ref{eq:vecpdbz}) erfolgt in den dafür modifizierten Routinen \texttt{ecp\_int\_ij} und \texttt{ecp\_grad\_ij}.

	\begin{itemize}[leftmargin=77pt]
	\item[\texttt{cvw\_ecp\_int}:] Berechnung der gewöhnlichen \ac{ecp}-Integrale, welche für den ersten Term auf der rechten Seite von Gleichugn \ref{eq:ecpintegral} benötigt werden. Die entsprechenden Beiträge für die Gleichungen (\ref{eq:vecpdbx})--(\ref{eq:vecpdbz}) werden in der von \texttt{cvw\_ecp\_int} gerufenen Routine \texttt{ecp\_int\_ij} zusammengesetzt.
	\item[\texttt{cvw\_ecp\_grad}:] Berechnung der \ac{ecp}-Gradientenintegrale, welche für den zweiten Term auf der rechten Seite von Gleichugn \ref{eq:ecpintegral} benötigt werden. Die entsprechenden Beiträge für die Gleichungen (\ref{eq:vecpdbx})--(\ref{eq:vecpdbz}) werden in der von \texttt{cvw\_ecp\_grad} gerufenen Routine \texttt{ecp\_grad\_ij} zusammengesetzt.
	\end{itemize} 
\newpage	
	\subsection{Testrechnungen}
	Zur Überprüfung der \ac{ecp}-Implementierung auf Eichinvarianz wurde das von drei 2-Phenylpyridin-(ppy-)Liganden oktaedrisch koordinierte Kobaltatom (Co(ppy)$_3$) betrachtet. Dieser Komplex ist oben links in Abbildung \ref{abb:coppy3test} mit optimierten Strukturparametern dargestellt. Die Berechnungen wurden unter Verwendung des BP86-Funktionals\supercite{perdew1986density,becke1988density} und der ECP10MDF-Basis und des ECP10MDF-\acp{ecp}\supercite{dolg1987energy} durchgeführt. Eine zusätzliche All-Elektronen-Rechnung erfolgte mit der def2-SV(P)-Basis\supercite{weigend2005balanced}. Dabei wurde der \ac{scf}-Energie-Konvergenzschwellwert auf $\unit[10^{-9}]{E_{\textrm{h}}}$ gesetzt und ein Gitter mittlerer Größe (\textsc{Turbomole} grid 3) für die numerische Integration\supercite{treutler1995efficient,treutlerphdthesis} verwendet. Die Strukturparameter wurden mit einem Energie-Konvergenzschwellwert von $\unit[10^{-8}]{E_{\textrm{h}}}$ und einem Konvergenzschwellwert von $\unit[10^{-6}]{E_{\textrm{h}}/a_0}$ für den kartesischen Gradienten optimiert. Die Eichinvarianz der Implementierung lässt sich dadurch überprüfen, dass die Berechnungen für zwei unterschiedliche Molekülpositionen im Raum durchgeführt und verglichen werden. Im ersten Fall befindet sich das Kobaltatom im Koordinatenursprung. Im zweiten Fall wird das Co(ppy)$_3$ um \unit[10]{a.u.} in Richtung der Raumdiagonalen verschoben (siehe Abbildung \ref{abb:coppy3test} \textsf{(b)}). Es ist deutlich zu erkennen, dass für beide Rechnungen dieselben Abschirmungskonstanten erhalten werden, was die Eichinvarianz der Implementierung bestätigt. Im Vergleich dazu wurden die entsprechenden Rechnungen ohne Berücksichtigung des von van Wüllen hergeleiteten Kommutators durchgeführt (Abbildung \ref{abb:coppy3test} \textsf{(c)}). Die Abweichungen zwischen diesen beiden Rechnungen sind deutlich zu erkennen. Weiterhin kommt es zu einer Aufspaltung der Abschirmungskonstanten für chemisch äquivalente Atome, insbesondere der Stickstoff- und C1-Kohlenstoffatome, was zu unphysikalischen Ergebnissen führt. Durch das noch vergleichsweise leichte Kobaltatom kann die Rechnung unter Verwendung eines \acp{ecp} gut mit einer nicht-\-re\-la\-tivistischen All-Elektronen-Rechnung verglichen werden, da relativistische Effekte hier -- falls überhaupt -- nur eine sehr kleine Rolle spielen. Die Abschirmungskonstanten der gesamten Verbindung (mit Ausnahme des Kobaltatoms), welche jeweils mit der entsprechenden Methode berechnet wurden, sind in der Graphik unten rechts in Abbildung \ref{abb:coppy3test} \textsf{(d)} gegeneinander aufgetragen. Wie zu erkennen ist, wird eine sehr gute Übereinstimmung erhalten. Geringe Unterschiede ergeben sich auch durch die Verwendung leicht unterschiedlicher Basissätze für das Kobaltatom. Erwartungsgemäß werden die größten Unterschiede für die Stickstoff- und Kohlenstoffatome erhalten, welche direkt an das Kobaltatom koordinieren. Der Einfluss des \acp{ecp} ist auf diese Atome am größten.  

\vfill
\newpage
\vspace{1cm}
\begin{figure}[ht!]
	\centering
	\includegraphics[width=1.0\textwidth]{ecptest}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[ECP-Testrechnungen an Co(ppy)$_3$]{\textsf{(a)} Abbildung von Co(ppy)$_3$, ppy=2-Phenylpyridin (Kohlenstoff=grau, Wasserstoff=weiß, Stickstoff=blau und Kobalt=grün).\\ \textsf{(b)} Abschirmungskonstanten von Co(ppy)$_3$  berechnet mit \acp{ecp}, wobei das Molekül um \unit[10]{a.u.} in Richtung der Raumdiagonalen verschoben wurde ($y$-Achse) aufgetragen gegen die Abschirmungskonstanten von Co(ppy)$_3$ berechnet mit \acp{ecp}, wobei das Co-Atom im Koordinatenursprung liegt ($x$-Achse).\\ \textsf{(c)} wie \textsf{(b)}, nur dass die Abschirmungskonstanten für das verschobene Molekül ohne den Beitrag durch den von van Wüllen hergeleiteten Kommutator berechnet wurden.\\ \textsf{(d)} Abschirmungskonstanten von Co(ppy)$_3$ berechnet mit \acp{ecp} ($y$-Achse) aufgetragen gegen die Abschirmungskonstanten von Co(ppy)$_3$ berechnet mit einer All-Elektronen-Basis ($x$-Achse).}
\label{abb:coppy3test}
\end{figure}
\vfill
\newpage

Wie bereits in Abschnitt \ref{kap:ecps} erwähnt, lassen sich für Atome mit \acp{ecp} keine physikalisch sinnvollen absoluten Abschirmungskonstanten berechnen. Jedoch können die berechneten Abschirmungskonstanten gut mit experimentell gemessenen chemischen Verschiebungen korreliert werden. Dies ist insbesondere dann möglich, wenn es sich dabei um ähnliche Systeme handelt. Um dies zu demonstrieren, wurden die Abschirmungskonstanten der Zinnatome in den Verbindungen SnH$_4$, SnMeH$_3$, SnMe$_2$H$_2$, SnMe$_3$H und SnMe$_4$ mit \acp{ecp} berechnet. Die experimentell gemessenen chemischen Verschiebungen dieser Verbindungen sind Referenz \cite{vivas2002dft} entnommen. In Abbildung \ref{abb:snecpshifts} sind die mit \acp{ecp} berechneten Abschirmungskonstanten gegen die experimentell gemessenen Daten aufgetragen. Es ist eindeutig zu erkennen, dass sich die berechneten Werte sehr gut mit den experimentellen Verschiebungen korrelieren lassen. Der Absolutwert der chemischen Verschiebung ist jedoch um 1--2 Größenordnungen kleiner, da die wesentlichen Beiträge der kernnahen Elektronen fehlen. Für diese Berechnungen gelten dieselben, oben bereits erwähnten Einstellungen mit der Ausnahme, dass das TPSS-Funktional\supercite{tao2003climbing} und die def2-TZVP-Basis\supercite{weigend2005balanced} verwendet wurden.
\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.6\textwidth]{snecpshifts}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Vergleich von experimentellen $^{119}$Sn-chemischen Verschiebungen mit berechneten Abschirmungskonstanten]{Vergleich von experimentellen $^{119}$Sn-chemischen Verschiebungen mit berechneten Abschirmungskonstanten mit \acp{ecp}. Die Absolutwerte der berechneten Abschirmungskonstanten sind um 1--2 Größenordnungen zu gering, jedoch lassen sie sich sehr gut mit den gemessenen Verschiebungen in Korrelation bringen.}
\label{abb:snecpshifts}
\end{figure}
	
\section{Berechnung von Vibrational\--Circular\--Dichroism\--Spektren}\label{kap:vcd}
Die \aclu*{vcd-}\mbox{(\acs{vcd}-)}\acused{vcd}Spektroskopie stellt eine wichtige Methode zur Bestimmung der absoluten Konfiguration in chiralen Molekülen dar und erlangte in der jüngeren Vergangenheit steigende Beliebtheit. Wichtig hierbei ist das Zusammenspiel zwischen Theorie und Experiment. Nur durch Vergleich gemessener und berechneter \ac{vcd}-Spektren lassen sich klare Aussagen treffen. Dies gibt dem Chemiker damit aber auch ein wichtiges Werkzeug zur Bestimmung absoluter Konfigurationen in die Hand.\supercite{magyarfalvi2011vibrational} Ein Beispiel ist in Abbildung \ref{abb:vcdintro} für Methyloxiran gezeigt. Die beiden Stereoisomere (\textit{R})- und (\textit{S})-Methyloxiran \textsf{(a)} besitzen dasselbe \ac{ir}-Spektrum \textsf{(b)} und lassen sich damit nicht unterscheiden. Anders im Fall der jeweiligen \ac{vcd}-Spektren. Da das Molekül nur ein stereogenes Zentrum besitzt, verhalten sich die beiden Stereoisomere wie Bild und Spiegelbild, sind also Enantiomere. Dasselbe trifft in diesem Fall auch auf die \ac{vcd}-Spektren zu. Die blaue Kurve ist das Spiegelbild der roten Kurve, wodurch die beiden Konfigurationen eindeutig voneinander unterschieden werden können. 

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.55\textwidth]{vcdintro}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[\ac{ir}- und \ac{vcd}-Spektren von (\textit{R})- und (\textit{S})-Methyloxiran]{Keilstrichformel von (\textcolor{myblue}{\textit{R}})- und (\textcolor{myred}{\textit{S}})-Methyloxiran \textsf{(a)}, simuliertes gemeinsames \ac{ir}-Spektrum \textsf{(b)} und die jeweils simulierten \ac{vcd}-Spektren \textsf{(c)}.}
\label{abb:vcdintro}
\end{figure}

Bei der Berechnung von \ac{vcd}-Spektren werden sowohl die Schwingungsfrequenzen als auch die magnetische Response des Moleküls auf ein externes Magnetfeld benötigt.\supercite{reiter2017vibrational} Insbesondere die Berechnung der Schwingungsfrequenzen ist besonders zeitaufwändig, sodass für größere Moleküle die \ac{dft} die Methode der Wahl ist. In einer ersten \ac{dft}-Implementierung von Cheeseman \textit{et al.}\supercite{cheeseman1996ab} wurde die Verlässlichkeit der Methode unter Verwendung von Hybridfunktionalen für das Oxiran gezeigt. 
\FloatBarrier

	\subsection{Theorie}
	Die im Experiment gemessenen Intensitäten der \ac{vcd}-Spektroskopie $I_n$ sind proportional zu den in quantenchemischen Rechnungen zugänglichen Rotationsstärken $R_n$. Letztere werden aus dem Skalarprodukt von elektrischem und vom magnetischem Übergangsdipolmoment, $\vec{\mu}_n^{\,\text{el}}$ und $\vec{\mu}_n^{\,\text{mag}}$,  erhalten. Somit ergibt sich die \ac{vcd}-Intensität
	\begin{equation}\label{eq:rotationsstaerke}
	  I_n\propto R_n = \textrm{Im}(\vec{\mu}_n^{\,\text{el}}\cdot\vec{\mu}_n^{\text{\,mag}})
	\end{equation}
	
	für einen Übergang aus dem Schwingungsgrundzustand in den angeregten Schwingungszustand $n$.\supercite{stephens1985theory,stephens1985vibrational} Im Rahmen der harmonischen Näherung sind das elektrische und das magnetische Übergangsdipolmoment gegeben durch\supercite{cheeseman1996ab,nicu2008vibrational}	
	\begin{equation}\label{eq:eludm}
	  (\vec{\mu}_n^{\,\text{el}})_\beta=\sqrt{\frac{\hbar}{\omega_n}}\sum_{K\alpha}P_{\alpha\beta}^K S_{K\alpha,n}\, ,
	\end{equation}
	\begin{equation}\label{eq:magudm}
	  (\vec{\mu}_n^{\,\text{mag}})_\beta=-\sqrt{2\hbar^3\omega_n}\sum_{K\alpha}M_{\alpha\beta}^KS_{K\alpha,n}\, .
	\end{equation}
	
	Hierbei ist $\omega_n$ ist die Schwingungsfrequenz der $n$-ten Schwingung und $S_{K\alpha,n}$ ist die Transformationsmatrix von kartesischen zu Normalkoordinaten. Sowohl der sogenannte \ac{apt} (Gleichung (\ref{eq:apt})) als auch der sogenannte \ac{aat} (Gleichung (\ref{eq:aat})) lassen sich in einen elektronischen und einen Kernbeitrag aufteilen,
	\begin{equation}\label{eq:apt}
	  P^K_{\alpha\beta}=E^K_{\alpha\beta}+N^K_{\alpha\beta}\, ,
	\end{equation}
	\begin{equation}\label{eq:aat}
   	  M^K_{\alpha\beta}=I^K_{\alpha\beta}+J^K_{\alpha\beta}\, .
	\end{equation}
	
	Die Berechnung der Kernbeiträge 
	\begin{equation}
	  N^K_{\alpha\beta}=eZ_K\delta_{\alpha\beta}\, ,
	\end{equation}
	\begin{equation}\label{eq:aatkern}
	  J^K_{\alpha\beta}=\iu\frac{eZ_K}{4\hbar c}\sum_K^{N_K}\varepsilon_{\alpha\beta\gamma}R^0_{K\gamma}
	\end{equation}
	
	ist trivial. $e$ ist die Elementarladung, $Z_K$ ist die Ladung des Kerns $K$ und $\delta_{\alpha\beta}$ ist das Kroneckerdelta. $\hbar$ ist das Planck'sche Wirkungsquantum, $c$ ist die Lichtgeschwindigkeit und $\varepsilon_{\alpha\beta\gamma}$ ist der Levi-Civita-Permutationstensor. Die Position des Kerns $K$ ist durch $R^0_{K\gamma}$ gegeben und die hochgestellte $0$ symbolisiert die Auswertung in der Gleichgewichtsgeometrie. Zur Berechnung der elektronischen Beiträge 
    \begin{equation}
      E^K_{\alpha\beta}=\left(\sum_{i=1}^{N_{\text{occ}}}\frac{\partial \langle\varphi_i\vert r_\beta\vert\varphi_i\rangle}{\partial R_{K\alpha}}\right)_{\vec{R}^0}\, , 
    \end{equation}
    \begin{equation}\label{eq:vcdaatel}
      I^K_{\alpha\beta}=\sum_{i}^{N_{\text{occ}}}\left\langle\left.\left(\frac{\partial \varphi_i}{\partial R_{K\alpha}}\right)_{\vec{R}^0}\right|\left(\frac{\partial \varphi_i}{\partial B_\beta}\right)_{\vec{B}=0}\right\rangle
    \end{equation}
    
    ist ein deutlich größerer Aufwand erforderlich. Wie bereits in Abschnitt \ref{theo:nmr} beschrieben, lässt sich die \ac{mo}-Ableitung nach einer Komponente des externen magnetischen Feldes im Rahmen des \ac{cphf}-Formalismus als 
    \begin{equation}\label{eq:vcdcphf}
    \left(\frac{\partial \varphi_i}{\partial B_\beta}\right)_{\vec{B}=0}=\varphi_i^{B_\beta}=\sum_{\mu}^{N_{\text{BF}}}\left[c_{\mu i}\chi_\mu^{B_\beta}+\sum_{p}^{N_{\text{MO}}}c_{\mu p}U_{pi}^{B_\beta}\chi_\mu\right]
	\end{equation}
	
	ausdrücken. Die Koeffizientenmatrix $U_{pi}^{B_\beta}$ beschreibt die Änderung der Molekülorbitale durch die Störung des äußeren magnetischen Feldes $\vec{B}$. Sie wird durch Lösen der entsprechenden \ac{cphf}-Gleichungen erhalten, ganz analog zur Vorgehensweise bei der Berechnung von \ac{nmr}-Abschirmungskonstanten. Die Kombination der Gleichungen (\ref{eq:vcdaatel}) und  (\ref{eq:vcdcphf}) liefert den zu implementierenden Ausdruck für den elektronischen Anteil des \ac{aat},
	\begin{equation}\label{eq:vcdaatelfinal}
	\begin{aligned}
	I^K_{\alpha\beta}=&\sum_{i}^{N_{\text{occ}}}\sum_{\mu,\nu}^{N_{\text{BF}}}\left[c_{\mu i}c_{\nu i}\left\langle\chi_\mu^{R_{K\alpha}}\vert\chi_\nu^{B_\beta}\right\rangle+\sum_{p}^{N_{\text{MO}}}c_{\mu i}c_{\nu p}U_{pi}^{B_\beta}\left\langle\chi_\mu^{R_{K\alpha}}\vert\chi_\nu\right\rangle\right.\\
	&\left.+\sum_{p}^{N_{\text{MO}}}c_{\mu i}c_{\nu p}U_{pi}^{R_{K_\alpha}}\left\langle\chi_\mu\vert\chi_\nu^{B_{\beta}}\right\rangle+\sum_{p,q}^{N_{\text{MO}}}c_{\mu p}c_{\nu q}U_{pi}^{R_{K_\alpha}}U_{qi}^{B_\beta}\left\langle\chi_\mu\vert\chi_\nu\right\rangle\right].
	\end{aligned}
	\end{equation}
	
	Durch die Koeffizientenmatrix $U_{pi}^{R_{K_\alpha}}$ wird die Response der Wellenfunktion auf die Verrückung des Kerns $K$ beschrieben. Analog zu $U_{pi}^{B_\beta}$ werden auch sie durch Lösen der entsprechenden \ac{cphf}-Gleichungen erhalten. Gebraucht werden sie ebenfalls zur Berechnung von Kraftkonstanten, wie sie im Modul \texttt{aoforce}\supercite{deglmann2002efficient} des Programmpakets \textsc{Turbomole} berechnet werden.
\vfill
\newpage
	
	\subsection{Implementierung}
Die Implementierung zur Berechnung von \ac{vcd}-Spektren lässt sich am einfachsten durch folgende zwei Schritte realisieren. Im ersten Schritt wird die Koeffizientenmatrix $U_{ip}^{B_\beta}$ im Modul \texttt{mpshift} berechnet und auf der Festplatte gespeichert. Diese wird vom Modul \texttt{aoforce} eingelesen, welches ebenfalls alle notwendigen Integrale, die $U_{ip}^{R_{K_\alpha}}$, den \ac{aat} (Gleichung \ref{eq:aat}) und den \ac{apt} (Gleichung \ref{eq:apt}) berechnet. Letzterer wird auch für die Berechnung von \ac{ir}-Intensitäten benötigt und steht daher im Modul \texttt{aoforce} bereits zu Verfügung. Aus dem \ac{aat} und dem \ac{apt} lassen sich schließlich die eigentlichen \ac{vcd}-Intensitäten berechnen. Der Hauptaufwand liegt daher in der Implementierung des \ac{aat} nach Gleichung (\ref{eq:vcdaatelfinal}). Das Integral im vierten Term dieser Gleichung ist ein gewöhnliches Überlappungsintegral und das Integral im zweiten Term ist das nach den Kernkoordinaten abgeleitete Überlappungsintegral. Auch diese Integrale stehen im Modul \texttt{aoforce} bereits zur Verfügung.	Die in Gleichung (\ref{eq:vcdaatelfinal}) auftretenden Integrale, welche die Ableitung nach dem externen Magnetfeld enthalten, lassen sich wie folgt umschreiben:
	\begin{equation}\label{eq:ddipx}
	\begin{aligned}
	\left\langle\chi_\mu^{R_{K_\alpha}}\vert\chi_\nu^{B_x}\right\rangle&=\left.\left\langle\chi_\mu^{R_{K_\alpha}}\left|\frac{\partial}{\partial B_x}\right.\chi_\nu\right\rangle\right|_{\vec{B}=0}=\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|\frac{-\iu}{2c}\left(R_{\nu y}z-R_{\nu z}y\right)\right|\chi_\nu^{\vec{B}=0}\right\rangle\\
	  &=\frac{\iu}{2c}\left(R_{\nu z}\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|y\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu y}\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|z\right|\chi_\nu^{\vec{B}=0}\right\rangle\right).
	  \end{aligned}
	\end{equation}
	
	Analog ergeben sich die Ableitungen nach der $y$-
	\begin{equation} \label{eq:ddipy}
	\left\langle\chi_\mu^{R_{K_\alpha}}\vert\chi_\nu^{B_y}\right\rangle=\frac{\iu}{2c}\left(R_{\nu x}\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|z\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu z}\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|x\right|\chi_\nu^{\vec{B}=0}\right\rangle\right)
	\end{equation}
	
	und der $z$-Komponente	
	\begin{equation} \label{eq:ddipz}
	\left\langle\chi_\mu^{R_{K_\alpha}}\vert\chi_\nu^{B_z}\right\rangle=\frac{\iu}{2c}\left(R_{\nu y}\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|x\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu x}\left\langle\chi_\mu^{R_{K_\alpha},\vec{B}=0}\left|y\right|\chi_\nu^{\vec{B}=0}\right\rangle\right).
	\end{equation}
	
	Die einzelnen Komponenten für das zweite Integral, welches die Ableitung nach dem Magnetfeld beinhaltet, (Term drei auf der rechten Seite in Gleichung (\ref{eq:vcdaatelfinal})) sind gegeben durch	
	\begin{equation} \label{eq:dipx}
	\begin{aligned}
	  \left\langle\chi_\mu\vert\chi_\nu^{B_x}\right\rangle&=\left.\left\langle\chi_\mu\left|\frac{\partial}{\partial B_x}\right.\chi_\nu\right\rangle\right|_{\vec{B}=0}=\left\langle\chi_\mu^{\vec{B}=0}\left|\frac{-\iu}{2c}\left(R_{\nu y}z-R_{\nu z}y\right)\right|\chi_\nu^{\vec{B}=0}\right\rangle\\
	  &=\frac{\iu}{2c}\left(R_{\nu z}\left\langle\chi_\mu^{\vec{B}=0}\left|y\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu y}\left\langle\chi_\mu^{\vec{B}=0}\left|z\right|\chi_\nu^{\vec{B}=0}\right\rangle\right),
	\end{aligned}
	\end{equation}
 
		\begin{equation} \label{eq:dipy}
	  \left\langle\chi_\mu\vert\chi_\nu^{B_y}\right\rangle=\frac{\iu}{2c}\left(R_{\nu x}\left\langle\chi_\mu^{\vec{B}=0}\left|z\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu z}\left\langle\chi_\mu^{\vec{B}=0}\left|x\right|\chi_\nu^{\vec{B}=0}\right\rangle\right),
	\end{equation}
	
		\begin{equation} \label{eq:dipz}
	  \left\langle\chi_\mu\vert\chi_\nu^{B_z}\right\rangle=\frac{\iu}{2c}\left(R_{\nu y}\left\langle\chi_\mu^{\vec{B}=0}\left|x\right|\chi_\nu^{\vec{B}=0}\right\rangle-R_{\nu x}\left\langle\chi_\mu^{\vec{B}=0}\left|y\right|\chi_\nu^{\vec{B}=0}\right\rangle\right).
	  \vspace{0.75cm}
	\end{equation}

	Die Integrale in den Gleichungen (\ref{eq:ddipx})--(\ref{eq:dipz}) lassen sich damit entsprechend durch eine Linearkombination von gewöhnlichen Dipolintegralen $\langle\chi_\mu\vert\vec{r}\vert\chi_\nu\rangle$ und nach den Kernkoordinaten abgeleiteten Dipolintegralen $\langle\chi_\mu^{R_{K_\alpha}}\vert\vec{r}\vert\chi_\nu\rangle$ ausdrücken. Diese werden bereits im Modul \texttt{aoforce} berechnet und müssen daher nur auf geeignete Weise kombiniert werden, um die nach den Komponenten des Magnetfeldes abgeleiteten Integrale zu erhalten. Mit den \ac{mo}-Koeffizienten lassen sich die Integrale in den Termen drei und vier aus der \aclu*{cao-}\mbox{(\acs{cao}-)}\acused{cao}Basis in die \ac{mo}-Basis transformieren und zusammenfassen zu\supercite{nicu2008vibrational}	
	\begin{equation}\label{eq:term3+4}
	\begin{aligned}
	&\sum_{\mu,\nu=1}^{N_{\text{BF}}}\left[\sum_{p=1}^{N_{\text{MO}}}c_{\mu p}c_{\nu i}U_{pi}^{R_{K_\alpha}}\left\langle\chi_\mu\vert\chi_\nu^{B_{\beta}}\right\rangle+\sum_{p,q=1}^{N_{\text{MO}}}c_{\mu p}c_{\nu q}U_{pi}^{R_{K_\alpha}}U_{qi}^{B_\beta}\left\langle\chi_\mu\vert\chi_\nu\right\rangle\right]\\
	&=\sum_{p=1}^{N_{\text{MO}}}U_{pi}^{R_{K_\alpha}}S_{pi}^{B_\beta}+\sum_{p,q=1}^{N_{\text{MO}}}U_{pi}^{R_{K_\alpha}}U_{qi}^{B_\beta}\delta_{pq}\\
	&=\sum_{p=1}^{N_{\text{MO}}}U_{pi}^{R_{K_\alpha}}S_{pi}^{B_\beta}+\sum_{p=1}^{N_{\text{MO}}}U_{pi}^{R_{K_\alpha}}U_{pi}^{B_\beta}\\
	&=\sum_{p=1}^{N_{\text{MO}}}U_{pi}^{R_{K_\alpha}}\left(S_{pi}^{B_\beta}+U_{pi}^{B_\beta}\right).
	\end{aligned}
	\vspace{0.75cm}
	\end{equation}
	
	Abbildung \ref{abb:programmstrukur_vcd} zeigt eine schematische Darstellung der wichtigsten Routinen für die Berechnung von \ac{vcd}-Spektren. Ihre genaue Funktion wird im Folgenden erläutert. 
\begin{itemize}[leftmargin=60pt]
	\item[\texttt{wrumunu}:] Transformation der $U_{pi}^{B_\beta}$ in die \ac{cao}-Basis. Anschließend werden die $U_{\mu\nu}^{B_\beta}$ in der Datei \texttt{umunu} auf der Festplatte gespeichert.
	\item[\texttt{scf2nd}:] Übergeordnete Routine zur Lösung der \ac{cphf}-Gleichungen für die $U_{pi}^{R_{K_\alpha}}$.
	\item[\texttt{dipai}:] Berechnung der Integrale in den Gleichungen (\ref{eq:dipx}) bis (\ref{eq:dipz}) aus den Dipolintegralen.
	\item[\texttt{dinumu}:] Übergeordnete Routine zur Berechnung der Dipolintegrale und der nach den Kernkoordinaten abgeleiteten Dipolintegrale.
	\item[\texttt{dipdrv}:] Berechnung der Integrale in den Gleichungen (\ref{eq:ddipx}) bis (\ref{eq:ddipz}) aus den nach den Kernkoordinaten abgeleiteten Dipolintegralen für den ersten Term auf der rechten Seite von Gleichung (\ref{eq:vcdaatelfinal}).
	\item[\texttt{gocart}:] Berechnung der ungestörten Überlappungsmatrix.
	\item[\texttt{dipsijxi}:] Übergeordnete Routine zur Berechnung des Produkts $U_{ji}^{R_{K_\alpha}}\left(S_{ji}^{B_\beta}+U_{ji}^{B_\beta}\right)$ aus Gleichung (\ref{eq:term3+4}) bzw. der Terme drei und vier aus der Gleichung (\ref{eq:vcdaatelfinal}) für den besetzt-besetzt Block. $S_{ji}^{B_\beta}+U_{ji}^{B_\beta}$ wird in \texttt{rdumunu} berechnet, das Produkt in \texttt{mijxidip}.
	\item[\texttt{rdumunu}:] Einlesen der $U_{\mu\nu}^{B_\beta}$ aus der Datei \texttt{umunu}. Anschließend erfolgt die Rücktransformation in die \ac{mo}-Basis sowie die Zerlegung in den besetzt-besetzt bzw. besetzt-virtuell Block. Des Weiteren werden an dieser Stelle auch die nach den Komponenten des Magnetfeldes abgeleiteten Überlappungsmatrizen aus den Gleichungen (\ref{eq:dipx}) bis (\ref{eq:dipz}) in die \ac{mo}-Basis transformiert. Schließlich erfolgt die Berechnung von $S_{ji}^{B_\beta}+U_{ji}^{B_\beta}$ und $S_{ai}^{B_\beta}+U_{ai}^{B_\beta}$.
	\item[\texttt{mijxidip}:] Eigentliche Berechnung des Produkts $U_{ji}^{R_{K_\alpha}}\left(S_{ji}^{B_\beta}+U_{ji}^{B_\beta}\right)$ für den besetzt-besetzt Block.
	\item[\texttt{dipuaixi}:] Übergeordnete Routine zur Berechnung des Produkts $U_{ai}^{R_{K_\alpha}}\left(S_{ai}^{B_\beta}+U_{ai}^{B_\beta}\right)$ aus Gleichung (\ref{eq:term3+4}) bzw. der Terme drei und vier aus der Gleichung (\ref{eq:vcdaatelfinal}) für den besetzt-virtuell Block. $S_{ai}^{B_\beta}+U_{ai}^{B_\beta}$ wird in \texttt{rdumunu} berechnet, das Produkt in \texttt{maixidip}.
	\item[\texttt{maixidip}:] Eigentliche Berechnung des Produkts $U_{ai}^{R_{K_\alpha}}\left(S_{ai}^{B_\beta}+U_{ai}^{B_\beta}\right)$ für den besetzt-virtuell Block.
	\item[\texttt{vibro}:] Übergeordnete Routine zur Berechnung des \ac{apt}, der \ac{vcd}-Ro\-ta\-tions\-stär\-ken und Ausgabe der Ergebnisse.
	\item[\texttt{prtnpr}:] Übergeordnete Routine zur Steuerung der Ergebnisausgabe. 
	\item[\texttt{wrtfrq}:] Ausgabe der \ac{vcd}-Rotationsstärken in \unit[1$\times 10^{-44}$]{esu$^2$cm$^2$} in der Datei \texttt{vibspectrum}.
	\item[\texttt{vibfrq}:] Übergeordnete Routine zur Berechnung des \ac{apt}, der \ac{vcd}-Ro\-ta\-tions\-stär\-ken und Ausgabe der Ergebnisse.
	\item[\texttt{rotvib}:] Berechnung des \ac{apt} nach Gleichung (\ref{eq:apt}) aus den nach den Kernkoordinaten abgeleiteten Dipolintegralen mit anschließender Transformation von kartesischen Koordinaten auf Normalkoordinaten nach Gleichung (\ref{eq:eludm}).
	\item[\texttt{mkvcd}:] Berechnung der eigentlichen \ac{vcd}-Rotationsstärken aus den bisherigen Zwischengrößen. Zuerst werden die nach den Komponenten der Kernkoordinaten abgeleitete Überlappungsmatrix $S_{\mu\nu}^{R_{K_\alpha}}=\left\langle\chi_\mu^{R_{K_\alpha}}\vert\chi_\nu\right\rangle$ und $U_{\mu\nu}^{B_\beta}$ in der \ac{cao}-Basis aus den Dateien \texttt{dS} und \texttt{umunu} eingelesen. Diese werden für den zweiten Term des \ac{aat} auf der rechten Seite von Gleichung (\ref{eq:vcdaatelfinal}) benötigt. Anschließend wird das Produkt $U_{\mu\nu}^{B_\beta}S_{\mu\nu}^{R_{K_\alpha}}$ gebildet. Als letzter für den \ac{aat} verbleibender Term wird der triviale Kernbeitrag nach Gleichung (\ref{eq:aatkern}) berechnet. Aus allen bisher berechneten Zwischengrößen (Term eins: \texttt{dipdrv}, Term zwei: \texttt{mkvcd}, Term drei und vier: \texttt{dipsijxi} und \texttt{dipuaixi}, Kernbeitrag: \texttt{mkvcd}) kann schließlich der gesamte \ac{aat} gebildet werden. Nach der Transformation des \ac{aat} von kartesischen Koordinaten auf Normalkoordinaten (Gleichung (\ref{eq:magudm})) werden die Rotationsstärken durch Skalarmultiplikation von $\vec{\mu}_n^{\,\text{el}}$ mit $\vec{\mu}_n^{\text{\,mag}}$ nach Gleichung (\ref{eq:rotationsstaerke}) erhalten.  
	\item[\texttt{prtram}:] Ausgabe der \ac{vcd}-Rotationsstärken in der Standard-Programmausgabe in \unit[1$\times 10^{-44}$]{esu$^2$cm$^2$}.
\end{itemize} 
	
	 
\vfill
\newpage	
\begin{figure}[ht!]
	\centering
	\includegraphics[width=1.0\textwidth]{vcd}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Wichtigste Routinen für die Berechnung von VCD-Intensitäten]{Schematische Darstellung der wichtigsten Routinen für die Berechnung von \ac{vcd}-Intensitäten in den Modulen \texttt{mpshift} und \texttt{aoforce}. Alte Routinen sind in blau, neue Routinen in grün, modifizierte Routinen in orange und unverändert übertragene Routinen in rot dargestellt.}
\label{abb:programmstrukur_vcd}
\end{figure}
	
\FloatBarrier
\vfill
\newpage
	\subsubsection{Symmetrieausnutzung}
	Nur wenige chirale Moleküle besitzen eine Symmetrie. Sie gehören alle zu den Punktgruppen $C_n$, $D_n$, $T$, $O$ oder $I$ und besitzen damit nur Drehachsen als Symmetrieelemente. Die bereits bestehende Implementierung der Symmetrieausnutzung\supercite{haser1991molecular} für die Module \texttt{mpshift} und \texttt{aoforce} kann auch für die Berechnung von \ac{vcd}-Spektren verwendet werden. Dabei ist jedoch zu beachten, dass die Symmetrieausnutzung im Modul \texttt{mpshift} keine Punktgruppen mit reduziblen $e$-Darstellungen unterstützt, was die Punktgruppen $C_{n>2}$ und $T$ unter den chiralen Punktgruppen betrifft. In diesen Fällen werden die \ac{mo}-Koeffizienten nach $C_1$ transformiert und das Modul \texttt{mpshift} wird ohne Symmetrieausnutzung verwendet. Die $U_{pi}^{B_\beta}$ Koeffizienten werden in die \ac{cao}-Basis transformiert, bevor sie für die Weiterverarbeitung im Modul \texttt{aoforce} auf der Festplatte gespeichert werden. Letzteres unterstützt die volle Symmetrieausnutzung, was wichtig ist, in Anbetracht der Tatsache, dass dies den zeitbestimmenden Schritt darstellt. In \texttt{aoforce} erfolgt die Berechnung der $U_{pi}^{R_{K_\alpha}}$, die $U_{pi}^{B_\beta}$ werden von der Festplatte eingelesen und für die volle Symmetrieausnutzung in die \aclu*{sao-}\mbox{(\acs{sao}-)}\acused{sao}Basis transformiert. Abschließend erfolgt die Berechnung der \ac{vcd}-Intensitäten.
	
	\subsection{Visualisierung von \acs{vcd}-Spektren}
	Zur Visualisierung der berechneten \ac{vcd}-Intensitäten und um sich einen schnellen, ersten Eindruck vom \ac{vcd}-Spektrum verschaffen zu können, wurde das Pythonskript \ac{gallier} erstellt. Die berechneten \ac{vcd}-Intensitäten und die korrespondierenden Frequenzen werden von dem Skript eingelesen und können im Anschluss daran mit gauß- oder lorentzförmigen Kurven verbreitert werden, wodurch ein simuliertes Spektrum erhalten wird. Der Benutzer hat dabei die Wahl, ob nur die Intensitäten in Form einfacher Linien, nur das simulierte Spektrum in Form verbreiteter Linien oder beides visualisiert werden soll. Standardmäßig wird dafür die von \texttt{aoforce} ausgegebene Datei \texttt{vibspectrum} eingelesen, wodurch auch simultan (oder ausschließlich) das Infrarotspektrum des untersuchten Moleküls visualisiert werden kann. Außerdem besteht zusätzlich die Möglichkeit eine beliebige $x,y$-Datei einzulesen um ein beliebiges Spektrum zu simulieren. \ac{gallier} erzeugt dafür ein Eingabeskript für das Visualisierungsprogramm gnuplot\supercite{gnuplot} sowie eine Datei mit den Rohdaten für jedes beliebige Visualisierungsprogramm. Die Halbwertsbreite sowie der zu zeichnende Bereich des Spektrums können direkt in \ac{gallier} ausgewählt werden.
	
	
	\subsection{Testrechnungen}
	Die Implementierungen von Cheeseman\supercite{cheeseman1996ab} und Nicu\supercite{nicu2008vibrational} wurden mehrfach auf kleinere und mittlere Moleküle angewendet. Dazu gehört beispielsweise die stereochemische Analyse von Glycerophospholipiden\supercite{taniguchi2015stereochemical}, die gemeinsame theoretische und experimentelle Untersuchung struktureller und spektroskopischer Eigenschaften von Cumarin-343-Fluoroionophoren\supercite{botek2010theoretical} oder die Aufklärung der absoluten Konfiguration des für den Geschmack von Wein verantwortlichen Iyoniresinols\supercite{cretin2015stereochemistry}. Als Repräsentant eines der größten Moleküle, für welche ein \ac{vcd}-Spektrum berechnet wurde, steht das \acf{cpa} (Abbildung \ref{abb:cpa}). Dieses beinhaltet 66 Nicht-Wasserstoffatome und wurde mit einem Hybridfunktional und einer \textit{double}-$\zeta$-Basis berechnet.\supercite{brotin2006vibrational} Durch die erfolgte Implementierung von \acp{ecp} im Modul \texttt{mpshift} lassen sich mit \textsc{Turbomole} nun auch \ac{vcd}-Spektren für Moleküle mit schweren Elementen berechnen, wodurch relativistische Effekte beschrieben werden können. Ein Beispiel dafür stellt das in Abbildung \ref{abb:irppy3} gezeigte Ir(ppy)$_3$, ppy=2-Phenylpyridin, dar. Dafür und für \ac{cpa} wurde im Folgenden der Einfluss des gewählten Funktionals und der gewählten Basis auf die Qualität des berechneten Spektrums, aber auch auf die Gesamtrechenzeit untersucht. Als typische Vertreter von reinen Dichte- und Hybridfunktionalen wurden BP86\supercite{perdew1986density,becke1988density} und B3LYP\supercite{becke1993density,lee1988development,stephens1994ab} in Kombination mit den Basissätzen def2-SV(P) und def2-TZVP\supercite{weigend2005balanced} verwendet. Erneut wurde der \ac{scf}-Energie-Konvergenzschwellwert auf $\unit[10^{-9}]{E_{\textrm{h}}}$ gesetzt und grid 3 von \textsc{Turbomole} für die numerische Integration\supercite{treutler1995efficient,treutlerphdthesis} verwendet. Die Strukturparameter wurden mit einem  Energie-Konvergenzschwellwert von $\unit[10^{-8}]{E_{\textrm{h}}}$ und einem Konvergenzschwellwert von $\unit[10^{-6}]{E_{\textrm{h}}/a_0}$ für den kartesischen Gradienten optimiert.	

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.5\textwidth]{cpa}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Abbildung von \ac{cpa}]{Abbildung von \ac{cpa} (Kohlenstoff=grau, Sauerstoff=rot). Die Wasserstoffatome wurden zur besseren Veranschaulichung bei der Abbildung weggelassen.}
\label{abb:cpa}
\end{figure}

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.5\textwidth]{irppy3}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Abbildung von Ir(ppy)$_3$]{Abbildung von Ir(ppy)$_3$, ppy=2-Phenylpyridin (Kohlenstoff=grau, Wasserstoff=weiß, Stickstoff=blau und Iridium=cyan).}
\label{abb:irppy3}
\end{figure}
\FloatBarrier




In Abbildung \ref{abb:irppy3_vcd} sind die \ac{vcd}-Spektren von Ir(ppy)$_3$ für die Kombinationen BP86/def2-TZVP, BP86/def2-SV(P), B3LYP/def2-TZVP und B3LYP/def2-SV(P) dargestellt. Abbildung \ref{abb:cpa_vcd} zeigt die äquivalenten Spektren für das \ac{cpa}-Molekül zusammen mit dem experimentellen Spektrum, welches Referenz \cite{brotin2006vibrational} entnommen ist. Wie anhand der Spektren beider Moleküle zu erkennen ist, können ihre qualitativen Eigenschaften als weitgehend unabhängig von den Funktionalen, aber auch von den Basissätzen angenommen werden. Im Falle von \ac{cpa} sind die Unterschiede untereinander jedenfalls deutlich kleiner als der Unterschied zum experimentellen Spektrum. Wie bei \ac{ir}-Spektren sind die mit dem Funktional BP86 erhalten Frequenzen, im Vergleich zum Funktional B3LYP, leicht rotverschoben. Beim Vergleich berechneter Spektren mit experimentell gemessener Spektren zur Bestimmung der absoluten Konfiguration ist die Kombination BP86/def2-SV(P) daher nicht weniger gut als die Kombination B3LYP/def2-TZVP. Dieser Befund hat ganz klare Vorteile im Bezug auf die Effizienz der Berechnungen, wie anhand Tabelle \ref{tab:vcdrechenzeit} deutlich wird. Die Berechnung des \ac{vcd}-Spektrums für Ir(ppy)$_3$ mit der Kombination B3LYP/def2-TZVP benötigt \unit[166]{h} auf einer einzelnen CPU, BP86/def2-TZVP nur noch \unit[17.5]{h} und BP86/def2-SV(P) nur noch \unit[2.2]{h}, was nur noch etwa 1.3 \% des Zeitbedarfs der ersten Rechnung darstellt. Klar ist außerdem, dass die Rechenzeit bei weitem durch den zweiten Schritt zur Berechnung der Kraftkonstanten (Modul \texttt{aoforce}) dominiert wird. Die Berechnung der magnetischen Response im Modul \texttt{mpshift} benötigt dahingegen lediglich 2 bis 5 \% der Gesamtrechenzeit. 

\begin{figure}[ht!]\vspace{2cm}
	\centering
	\includegraphics[width=0.75\textwidth]{irppy3_vcd}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Simulierte \ac{vcd}-Spektren von Ir(ppy)$_3$]{Simulierte \ac{vcd}-Spektren von Ir(ppy)$_3$ für die folgenden Funktional/Basissatz-Kombinationen: BP86/def2-TZVP, BP86/def2-SV(P), B3LYP/def2-TZVP und B3LYP/def2-SV(P). Zur Verbreiterung der Linien wurden Lorentzkurven verwendet. Die Halbwertsbreite beträgt \unit[4]{cm$^{-1}$}.}
\label{abb:irppy3_vcd}
\end{figure}
\vfill
\newpage
\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.75\textwidth]{cpa_vcd}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Simulierte \ac{vcd}-Spektren von \ac{cpa}]{Simulierte \ac{vcd}-Spektren von \ac{cpa} für die folgenden Funktional/Basissatz-Kombinationen: BP86/def2-TZVP, BP86/def2-SV(P), B3LYP/def2-TZVP und B3LYP/def2-SV(P) \textsf{(a)}. Zur Verbreiterung der Linien wurden Lorentzkurven verwendet. Die Halbwertsbreite beträgt \unit[4]{cm$^{-1}$}. Das experimentelle Spektrum \textsf{(b)} ist aus Referenz \cite{brotin2006vibrational} entnommen. Nachdruck mit Erlaubnis von Referenz \cite{brotin2006vibrational}. Copyright 2006 American Chemical Society.}
\label{abb:cpa_vcd}
\end{figure}
\vfill
\newpage

\begin{table}[ht!]
\captionsetup{tablewithin = chapter}
\captionsetup{font=small, labelfont=bf}
\captionabove[Rechenzeiten für \ac{vcd}-Spektren]{Rechenzeiten in Stunden auf einem Intel\textsuperscript{\textregistered} Xeon\textsuperscript{\textregistered} Prozessor E5-2687W v2, 3.4 GHz für Ir(ppy)$_3$ und \ac{cpa} für unterschiedliche Rechenparameter. $N_{\textrm{BF}}$ entspricht der Anzahl der Basisfunktionen und $N_{\textrm{CPU}}$ der Anzahl an verwendeten CPUs für den \texttt{aoforce}-Schritt. Auf den Basiszusatz \glqq def2-\grqq{} wurde verzichtet.}
\resizebox{\textwidth}{!}{%
\begin{tabular}{llSccSSSS}
\hline \hline
Funktional & Basis & $N_{\textrm{BF}}$ & Symmetrie & $N_{\textrm{CPU}}$ & \text{Laufzeit} & \texttt{mpshift} & \texttt{aoforce} & \texttt{aoforce} \\ 
 & & & & & & \text{(CPU)} & \text{(CPU)} & \text{(Laufzeit)}\\
\hline
 & & & & & & & & \\
\multicolumn{9}{c}{\text{Ir(ppy)}$_3$, \text{ppy=2-Phenylpyridin}}\\
B3LYP & TZVP & 1300 & $C_3$ & 1 & 166.09 & 4.91 & 161.05 & 161.18\\
B3LYP & SV(P) & 577 & $C_3$ & 1 & 10.37 & 0.29 & 10.07 & 10.08\\
B3LYP & SV(P) & 577 & $C_1$ & 1 & 16.68 & 0.29 & 16.27 & 16.39\\
BP86  & TZVP & 1300 & $C_3$ & 1 & 17.49 & 0.89 & 16.59 & 16.60\\
BP86 & SV(P) & 577 & $C_3$ & 1 & 2.17 & 0.08 & 2.09 & 2.09\\
BP86 & SV(P) & 577 & $C_1$ & 1 & 4.45 & 0.08 & 4.36 & 4.37\\
 & & & & & & & & \\

\multicolumn{9}{c}{\text{Cryptophan-A}}\\
B3LYP & TZVP & 2370 & $D_3$ & 4 & 92.10 & 2.58 & 352.70 & 89.47\\
B3LYP & SV(P) & 1032 & $D_3$ & 4 & 5.67 & 0.14 & 21.30 & 5.53\\
B3LYP & SV(P) & 1032 & $D_3$ & 1 & 19.24 & 0.14 & 18.94 & 19.10\\
B3LYP & SV(P) & 1032 & $C_1$ & 4 & 22.93 & 0.80 & 86.09 & 22.13\\
B3LYP & SV(P) & 1032 & $C_1$ & 1 & 105.87 & 0.80 & 104.98 & 105.07\\
BP86 & TZVP & 2370 & $D_3$ & 4 & 11.16 & 0.45 & 34.53 & 10.71\\
BP86 & TZVP & 2370 & $D_3$ & 1 & 34.18 & 0.45 & 33.36 & 33.73\\
BP86 & TZVP & 2370 & $C_1$ & 4 & 48.16 & 2.70 & 174.58 & 45.46\\
BP86 & TZVP & 2370 & $C_1$ & 1 & 180.20 & 2.70 & 177.22 & 177.50\\
BP86 & SV(P) & 1032 & $D_3$ & 4 & 1.21 & 0.04 & 3.65 & 1.17
\end{tabular}}
\label{tab:vcdrechenzeit}
\end{table}
\FloatBarrier
Durch die Symmetrieausnutzung kann die Rechenzeit weiter verkürzt werden. Die Ausnutzung der $C_3$-Symmetrie bei der Berechnung des \ac{vcd}-Spektrums von Ir(ppy)$_3$ reduziert die Gesamtrechenzeit um einen Faktor 1.6 bis 2.0. Dies ist weniger als die Ordnung der Punktgruppe, was vermutlich daran liegt, dass die Spalten der reduziblen $e$-Darstellung, wie sie in der Punktgruppe $C_3$ enthalten sind, separat behandelt werden müssen. Besser sieht es im Fall des $D_3$-symmetrischen \ac{cpa} aus. Hier wird eine Reduzierung der Rechenzeit um einen Faktor nahe der Ordnung der Punktgruppe (6) erhalten. Ein zusätzlicher Zeitgewinn kann durch eine moderate Parallelisierung erreicht werden und ist insbesondere bei größeren Verbindungen wie dem \ac{cpa} von Vorteil. An dieser Stelle sei angemerkt, dass das Modul \texttt{mpshift} zu dem Zeitpunkt, als diese Rechnungen durchgeführt wurden, noch nicht parallel ausgeführt werden konnte. Die in Tabelle \ref{tab:vcdrechenzeit} angegebene Anzahl an CPUs bezieht sich damit immer auf das Modul \texttt{aoforce}. Die Rechenzeiten für das Ausführen von \texttt{aoforce} auf 4 CPUs sind ebenfalls in der Tabelle angegeben. Dabei wird eine Reduzierung der Gesamtrechenzeit um etwa den Faktor 3.5 erhalten. Zusätzlich ist noch die Beschleunigung der Berechnung für die Kombination BP86/def2-TZVP/$C_1$ angegeben. Diese beträgt 6.9 bzw. 11.3 auf 8 bzw. 16 CPUs.


Als illustratives Beispiel und zur Untersuchung des Skalierungsverhaltens wurden die \ac{vcd}-Spektren von großen chiralen Kohlenstoffclustern mit $I$-, aber nicht $I_\textrm{h}$-Symmetrie berechnet. Die Cluster C$^{2+}_{140}$, C$^{2+}_{260}$, C$^{2+}_{380}$, C$_{420}$ und C$^{2+}_{620}$ sind in Abbildung \ref{abb:carboncluster} gezeigt, die mit BP86/def2-SVP berechneten \ac{vcd}-Spektren in Abbildung \ref{abb:carboncluster_vcd}. Im Falle des C$^{2+}_{620}$ entspricht dies 8680 Basisfunktionen und es ist nach meinem Kenntnisstand das größte Molekül, für welches ein \ac{vcd}-Spektrum berechnet wurde. Alle Berechnungen wurden auf einer einzelnen CPU durchgeführt. Abbildung \ref{abb:vcdskalierung} zeigt eine doppelt logarithmische Auftragung der Rechenzeiten gegen die Anzahl der Kohlenstoffatome. Die durch lineare Anpassung erhaltenen Steigungen sind 2.27 $\pm$ 0.05 für \texttt{mpshift} bzw. 3.49 $\pm$ 0.16 für \texttt{aoforce}. Das Gesamtskalierungsverhalten ist damit etwas schlechter als $\mathcal{O}(N^3)$ und sehr dicht beim Skalierungsverhalten für die Berechnung von \ac{ir}-Spektren. Der zusätzliche Aufwand für die Berechnung der \ac{vcd}-Spektren im Vergleich zu letzteren liegt im Wesentlichen am \texttt{mpshift}-Schritt. Dessen Beitrag zur Gesamtrechenzeit ist gering und nimmt mit steigender Systemgröße ab. So wurden beispielsweise für den größten Cluster \unit[4.4]{h} für den \texttt{mpshift}-Schritt und 35 Tage für den \texttt{aoforce}-Schritt benötigt. Die gezeigten \ac{vcd}-Spektren sind charakteristisch für die jeweilige Verbindung, lassen jedoch keinen systematischen Trend erkennen.
\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.6\textwidth]{carboncluster}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Abbildung von ikosaedrischen Kohlenstoffclustern]{Abbildung von ikosaedrischen Kohlenstoffclustern mit \textit{I}-Symmetrie: C$^{2+}_{140}$ \textsf{(a)}, C$^{2+}_{260}$ \textsf{(b)}, C$^{2+}_{380}$ \textsf{(c)}, C$_{420}$ \textsf{(d)} und C$^{2+}_{620}$ \textsf{(e)}.}
\label{abb:carboncluster}
\end{figure}

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.65\textwidth]{carboncluster_vcd}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Simulierte \ac{vcd}-Spektren von ikosaedrischen Kohlenstoffclustern]{Simulierte \ac{vcd}-Spektren von C$^{2+}_{140}$, C$^{2+}_{260}$, C$^{2+}_{380}$, C$_{420}$ und C$^{2+}_{620}$ mit BP86/def2-SV(P). Zur Verbreiterung der Linien wurden Lorentzkurven verwendet. Die Halbwertsbreite beträgt \unit[4]{cm$^{-1}$}.}
\label{abb:carboncluster_vcd}
\end{figure}

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.6\textwidth]{vcdskalierung}
	\captionsetup{figurewithin = chapter}
	\captionsetup{font=small, labelfont=bf}\caption[Skalierung von \texttt{mpshift} und \texttt{aoforce}]{Doppelt logarithmische Auftragung der CPU-Rechenzeit für die beiden Module \texttt{aoforce} (Sterne) und \texttt{mpshift} (Quadrate) gegen die Anzahl der Kohlen\-stoff\-ato\-me in den ikosaedrischen Kohlenstoffclustern. Die Gesamtrechenzeiten (\texttt{mpshift} + \texttt{aoforce}) betragen 4.7/30.2/117.5/169.7/\unit[856.8]{h} für die Cluster mit 140/260/380/420/620 Kohlenstoffatomen. Eine lineare Anpassung liefert eine Steigung von 2.27 $\pm$ 0.05 für \texttt{mpshift} und 3.49 $\pm$ 0.16 für \texttt{aoforce}.}
\label{abb:vcdskalierung}
\end{figure}
	
\section{meta-GGA-Funktionale}\label{kap:mgga}
In Zusammenarbeit mit Fabian Mack wurde im Rahmen seiner Masterarbeit das Modul \texttt{mpshift} um die Möglichkeit erweitert, \ac{mgga}-Funktionale bei der Berechnung von Abschirmungskonstanten zu verwenden. Zunächst wurden dafür effizientere \ac{dft}-Routinen, welche bereits in anderen Modulen des \textsc{Turbomole} Programmpakets verwendet werden, in das Modul \texttt{mpshift} übertragen und für die Berechnung von Abschirmungskonstanten angepasst. Eine kurze Beschreibung dieser niedrig skalierenden Routinen ist in Referenz \cite{deglmann2002efficient} zu finden. Die zusätzlichen Terme, die bei der Funktionalableitung nach den Komponenten des Magnetfeldes bei der Verwendung von \ac{mgga}-Funktionalen auftreten (siehe Gleichung (\ref{eq:ymunudb}) bzw. (\ref{eq:mggadb})), mussten neu programmiert werden. Dafür wurde die neue Routine \texttt{csmoper} angelegt. Im Detail ist die Implementierung sowie der Aufbau der Routine in Referenz \cite{mack2017} beschrieben. Die Genauigkeit der Berechnung von chemischen Verschiebungen mit \ac{mgga}-Funktionalen wurde für $^{13}$C-, $^{19}$F- und $^{31}$P-chemische Verschiebungen getestet und mit \ac{gga}-Funktionalen verglichen.\supercite{reiter2017calculation} Eine ausführliche Studie darüber findet sich in Kapitel \ref{genauigkeit}.
	
	